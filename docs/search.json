[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "modelling",
    "section": "",
    "text": "Introduction\nmodelling is a sub-project of the BioForest project aimed at species related data (correct names, functional traits, phylogeny) as part of the data preparation for data preparation within the project."
  },
  {
    "objectID": "index.html#usage",
    "href": "index.html#usage",
    "title": "modelling",
    "section": "Usage",
    "text": "Usage\nAll modelling analyses rely on the quarto documents (files.qmd) that can be run with R and associated environment defined with renv."
  },
  {
    "objectID": "index.html#project",
    "href": "index.html#project",
    "title": "modelling",
    "section": "Project",
    "text": "Project\nmodelling includes:\n\nAnalyse of the data with associated documentation and figures:\n\nReproductive analyses in files.qmd\nResulting pages in docs/\nDocument structure definition in _quarto.yml\n\nAutomatic per site reports for PIs analyses/\nData in data/ with:\n\nAll raw data in raw_data/\nAll derived data in derived_sata/\n\nStan Bayesian models in models/\nStan Bayesian models outputs in chains/\nR scripts with funtions in r/\nIntermediary files in outputs/\nFigures in figures/\nR environment definition with renv in renv/ and renv/lock\nR files (.Rbuildignore , .Rdata , .Rprofile , .Rhistory, .lintr)\nGit and GitHub files (.gitignore , .github/)\nProject documentation (README.qmd , README.md , NEWS.md, LICENSE )"
  },
  {
    "objectID": "index.html#contribution",
    "href": "index.html#contribution",
    "title": "modelling",
    "section": "Contribution",
    "text": "Contribution\nYou can contribute to the project by forking the repository on github and cloning the fork to your machine using several options, including GitHub desktop GUI. Further informations on contribution are detailed in the online document: https://bioforest-project.github.io/data_preparation/98_contributing.html."
  },
  {
    "objectID": "index.html#help",
    "href": "index.html#help",
    "title": "modelling",
    "section": "Help",
    "text": "Help\nPlease preferentially create an issue on GitHub for any questions, bugs or help needed regarding modelling: https://github.com/Bioforest-project/modelling/issues . You may however reach us by mail with people from the core group (see below)."
  },
  {
    "objectID": "index.html#core-group",
    "href": "index.html#core-group",
    "title": "modelling",
    "section": "Core group",
    "text": "Core group\n\nSylvain Schmitt (sylvain.schmitt@cirad.fr)\nCamille Piponiot-Laroche (camille.piponiot-laroche@cirad.fr)\nBruno Hérault (bruno.herault@cirad.fr)\n\nThe whole group consist of participants to the Bioforest project."
  },
  {
    "objectID": "11_observations.html",
    "href": "11_observations.html",
    "title": "Observations",
    "section": "",
    "text": "Data exploration.\n\n\nCode\nmetadata &lt;- read_sheet(\"https://docs.google.com/spreadsheets/d/1fq2owxMBLBwwibcdw2uQQFxnIhsMbaH4Qcj_xUwVvSQ/edit?gid=0#gid=0\", col_types = \"c\") %&gt;% # nolint\n  rename_all(tolower) %&gt;%\n  select(site, plot, treatment, year_of_harvest) %&gt;%\n  separate(year_of_harvest, \"year_of_harvest\") %&gt;%\n  mutate(year_of_harvest = as.numeric(year_of_harvest)) %&gt;%\n  rename(harvest_year = year_of_harvest) %&gt;%\n  mutate(treatment = ifelse(\n    treatment %in% c(\"control\", \"Control\", \"Natural_Forest\"),\n    \"control\", \"logged\"\n  )) %&gt;%\n  group_by(site) %&gt;%\n  mutate(harvest_year_min = min(harvest_year, na.rm = TRUE)) %&gt;%\n  mutate(harvest_year = ifelse(site == \"Paracou\", 1986, harvest_year)) %&gt;%\n  mutate(harvest_year_min = ifelse(site == \"Paracou\", 1986, harvest_year_min))\ndata &lt;- read_csv(\"data/raw_data/aggregated_data.csv\") %&gt;%\n  rename_all(tolower) %&gt;%\n  left_join(metadata) %&gt;%\n  filter(!(site %in% c(\"Peteco\", \"Bafog\", \"Tene\",\n                       \"Montagne_Tortue\", \"Manare\"))) %&gt;%\n  filter(!(site == \"Kabo\" & year &lt; 1980)) %&gt;%\n  mutate(rel_year = ifelse(treatment == \"control\",\n    year - harvest_year_min,\n    year - harvest_year\n  )) %&gt;%\n  mutate(sitenum = as.numeric(as.factor(site))) %&gt;%\n  group_by(site) %&gt;%\n  mutate(y = ifelse(variable == \"agb\" & site == \"Kibale\",\n    300, value\n  )) %&gt;%\n  ungroup()\ndata_rec &lt;- data %&gt;%\n  filter(treatment == \"logged\", rel_year &gt; 2) %&gt;%\n  mutate(plotnum_rec = as.numeric(as.factor(paste0(site, \"_\", plot))))\ndata_pre &lt;- data %&gt;%\n  filter(rel_year &lt;= 0) %&gt;%\n  mutate(plotnum_pre = as.numeric(as.factor(paste0(site, \"_\", plot))))\ndata_old &lt;- data %&gt;%\n  filter(treatment == \"control\") %&gt;%\n  mutate(plotnum_old = as.numeric(as.factor(paste0(site, \"_\", plot))))\nwrite_tsv(data, \"data/derived_data/data.tsv\")\nwrite_tsv(data_rec, \"data/derived_data/data_rec.tsv\")\nwrite_tsv(data_pre, \"data/derived_data/data_pre.tsv\")\nwrite_tsv(data_old, \"data/derived_data/data_old.tsv\")\n\n\n\n\nCode\nread_tsv(\"data/derived_data/data.tsv\") %&gt;%\n  ggplot(aes(year, value, group = paste(site, plot))) +\n  geom_line() +\n  theme_bw() +\n  facet_wrap(~variable, scales = \"free_y\") +\n  theme(\n    axis.title = element_blank(),\n    strip.text = element_text(size = 6)\n  )\n\n\n\n\n\nAll attributes trajectories.\n\n\n\n\n\n\nCode\nmake_fig &lt;- function(var) {\n  g &lt;- read_tsv(\"data/derived_data/data.tsv\") %&gt;%\n    filter(variable == var) %&gt;%\n    ggplot(aes(year, value, group = paste(site, plot), col = treatment)) +\n    geom_line() +\n    theme_bw() +\n    xlab(\"\") +\n    ylab(\"\") +\n    facet_wrap(~site, scales = \"free\") +\n    geom_vline(aes(xintercept = harvest_year)) +\n    theme(legend.position = \"bottom\") +\n    ggtitle(var)\n  ggsave(plot = g, filename = paste0(\"figures/obs/\", var, \".png\"))\n}\nunique(read_tsv(\"data/derived_data/data.tsv\")$variable) %&gt;%\n  lapply(make_fig)\n\n\n\n\nCode\nread_tsv(\"data/derived_data/data.tsv\") %&gt;%\n  filter(variable == \"agb\") %&gt;%\n  ggplot(aes(year, value, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(expression(\"AGB [\" ~ Mg ~ ha^{\n    -1\n  } ~ \"]\")) +\n  facet_wrap(~site, scales = \"free\") +\n  geom_vline(aes(xintercept = harvest_year)) +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\nAGB trajectories across sites and treatments."
  },
  {
    "objectID": "21_models.html#ltp",
    "href": "21_models.html#ltp",
    "title": "Models",
    "section": "LTP",
    "text": "LTP\nLong term process only model:\n\\[\n\\begin{align}\n\\mu_{rec} = \\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times LTP \\\\\nLTP = 1 - e^{-\\lambda_p \\times time}\n\\end{align}\n\\]\nThe model we use is derived from the common framework for modelling recovery in disturbed tropical forests (Maurent et al. 2023). The forest attribute is first disturbed at \\(t=0\\) with either an increase or a decrease depending on the parameter \\(dist\\). Then the attributes recover asymptotically in the long term to an equilibrium value \\(\\theta_{Inf}\\) with a recovery rate \\(\\lambda\\).\n\n\nCode\nltp &lt;- function(time, dist, thetainf, lambda) {\n  theta0 &lt;- thetainf * dist\n  ltp &lt;- 1 - exp(-lambda * time)\n  return(theta0 + (thetainf - theta0) * (ltp))\n}\ndata.frame(time = seq(0.1, 50, length.out = 100)) %&gt;%\n  mutate(y_ltp = ltp(time, dist = 0.5, thetainf = 20, lambda = 0.05)) %&gt;%\n  bind_rows(data.frame(time = 0, y_stp = 20, y_ltp = 20)) %&gt;%\n  ggplot(aes(time)) +\n  geom_line(aes(y = y_ltp)) +\n  theme_bw() +\n  annotate(\"text\",\n    x = 52, y = 19.5, label = \"theta[Inf]\",\n    col = \"#9ea1d4\", parse = TRUE, size = 5\n  ) +\n  annotate(\"text\",\n    x = 20, y = 15, label = \"lambda\",\n    col = \"#a8d2d1\", parse = TRUE, size = 5\n  ) +\n  annotate(\"text\",\n    x = -4, y = 15, label = \"dist\",\n    col = \"#fc8a8a\", parse = TRUE, size = 5\n  ) +\n  theme(axis.title = element_blank()) +\n  geom_segment(aes(x = -2, y = 10, xend = -2, yend = 20),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#fc8a8a\"\n  ) +\n  geom_segment(aes(x = -2, y = 20, xend = -2, yend = 10),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#fc8a8a\"\n  )\n\n\n\n\n\nLTP proj with pars."
  },
  {
    "objectID": "21_models.html#stp",
    "href": "21_models.html#stp",
    "title": "Models",
    "section": "STP",
    "text": "STP\nLong term and short term processes model based on disturbance index \\(dist\\):\n\\[\n\\begin{align}\n\\mu_{rec} = \\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times (LTP+STP) \\\\\nLTP = 1 - e^{-\\lambda_p \\times time} \\\\\nSTP = \\delta_p \\times (\\frac{time}{\\tau_s} \\times e^{1-\\frac{time}{\\tau_s}})^2 \\\\\n\\theta_{0,p} = \\theta_{\\infty,s} \\times dist_p\n\\end{align}\n\\]\nThe model we use is derived from the common framework for modelling recovery in disturbed tropical forests (Maurent et al. 2023). The forest attribute is first disturbed at \\(t=0\\) with either an increase or a decrease depending on the parameter \\(dist\\). Then the attributes recover asymptotically in the long term to an equilibrium value \\(\\theta_{Inf}\\) with a recovery rate \\(\\lambda\\). But in this second version the recovery trajectory can also accommodate a short term increase of decrease of the attribute at a time \\(\\tau\\) with an intensity \\(\\delta\\).\n\n\nCode\nstp &lt;- function(time, dist, thetainf, lambda, tau, delta) {\n  theta0 &lt;- thetainf * dist\n  ltp &lt;- 1 - exp(-lambda * time)\n  stp &lt;- delta * (time / tau * exp(1 - time / tau))^2\n  return(theta0 + (thetainf - theta0) * (ltp + stp))\n}\ndata.frame(time = seq(0.1, 50, length.out = 100)) %&gt;%\n  mutate(y_stp = stp(time,\n    dist = 0.5, thetainf = 20, lambda = 0.05,\n    tau = 5, delta = 1\n  )) %&gt;%\n  mutate(y_ltp = ltp(time, dist = 0.5, thetainf = 20, lambda = 0.05)) %&gt;%\n  bind_rows(data.frame(time = 0, y_stp = 20, y_ltp = 20)) %&gt;%\n  ggplot(aes(time)) +\n  geom_line(aes(y = y_ltp), col = \"grey\") +\n  geom_line(aes(y = y_stp)) +\n  theme_bw() +\n  annotate(\"text\",\n    x = 52, y = 19.5, label = \"theta[Inf]\",\n    col = \"#9ea1d4\", parse = TRUE, size = 5\n  ) +\n  annotate(\"text\",\n    x = 20, y = 15, label = \"lambda\",\n    col = \"#a8d2d1\", parse = TRUE, size = 5\n  ) +\n  annotate(\"text\",\n    x = -4, y = 15, label = \"dist\",\n    col = \"#fc8a8a\", parse = TRUE, size = 5\n  ) +\n  theme(axis.title = element_blank()) +\n  geom_segment(aes(x = -2, y = 10, xend = -2, yend = 20),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#fc8a8a\"\n  ) +\n  geom_segment(aes(x = -2, y = 20, xend = -2, yend = 10),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#fc8a8a\"\n  ) +\n  annotate(\"text\",\n    x = 6, y = 11.3, label = \"tau\",\n    col = \"#f2e5a9\", parse = TRUE, size = 5\n  ) +\n  annotate(\"text\",\n    x = 5, y = 17.5, label = \"delta\",\n    col = \"#a7d6ac\", parse = TRUE, size = 5\n  ) +\n  geom_segment(aes(x = 6, y = 13, xend = 6, yend = 22),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#a7d6ac\"\n  ) +\n  geom_segment(aes(x = 6, y = 22, xend = 6, yend = 13),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#a7d6ac\"\n  ) +\n  geom_segment(aes(x = 6, y = 11, xend = 6, yend = 10),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#f2e5a9\"\n  ) +\n  theme(axis.title = element_blank())\n\n\n\n\n\nSTP proj with pars.\n\n\n\n\n\nChoices (to be developed as text in an appendix):\n\nUsing the log of y and a normal distribution centred on log(mu)\nCauchy hyperdist\nForced dist_p&lt;1\nBounds of theta\nFree tau\nFree delta\n\n⚠️ Hump is mathematically opposed to the sign of dist_p-1.\n\n\n\n\n\nMaurent, Eliott, Bruno Hérault, Camille Piponiot, Géraldine Derroire, Diego Delgado, Bryan Finegan, Mélaine Aubry Kientz, Bienvenu H. K. Amani, and Marie Ange Ngo Bieng. 2023. “A Common Framework to Model Recovery in Disturbed Tropical Forests.” Ecological Modelling 483 (September): 110418. https://doi.org/10.1016/j.ecolmodel.2023.110418."
  },
  {
    "objectID": "30_trajectories.html",
    "href": "30_trajectories.html",
    "title": "Trajectories",
    "section": "",
    "text": "This section develop trajectories per attributes. Boundaries of each parameter are listed below with the figure summarising the meaning of each parameter on the trajectory.\n\n\nCode\nltp &lt;- function(time, dist, thetainf, lambda) {\n  theta0 &lt;- thetainf * dist\n  ltp &lt;- 1 - exp(-lambda * time)\n  return(theta0 + (thetainf - theta0) * (ltp))\n}\nstp &lt;- function(time, dist, thetainf, lambda, tau, delta) {\n  theta0 &lt;- thetainf * dist\n  ltp &lt;- 1 - exp(-lambda * time)\n  stp &lt;- delta * (time / tau * exp(1 - time / tau))^2\n  return(theta0 + (thetainf - theta0) * (ltp + stp))\n}\ndata.frame(time = seq(0.1, 50, length.out = 100)) %&gt;%\n  mutate(y_stp = stp(time,\n    dist = 0.5, thetainf = 20, lambda = 0.05,\n    tau = 5, delta = 1\n  )) %&gt;%\n  mutate(y_ltp = ltp(time, dist = 0.5, thetainf = 20, lambda = 0.05)) %&gt;%\n  bind_rows(data.frame(time = 0, y_stp = 20, y_ltp = 20)) %&gt;%\n  ggplot(aes(time)) +\n  geom_line(aes(y = y_ltp), col = \"grey\") +\n  geom_line(aes(y = y_stp)) +\n  theme_bw() +\n  annotate(\"text\",\n    x = 52, y = 19.5, label = \"theta[Inf]\",\n    col = \"#9ea1d4\", parse = TRUE, size = 5\n  ) +\n  annotate(\"text\",\n    x = 20, y = 15, label = \"lambda\",\n    col = \"#a8d2d1\", parse = TRUE, size = 5\n  ) +\n  annotate(\"text\",\n    x = -4, y = 15, label = \"dist\",\n    col = \"#fc8a8a\", parse = TRUE, size = 5\n  ) +\n  theme(axis.title = element_blank()) +\n  geom_segment(aes(x = -2, y = 10, xend = -2, yend = 20),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#fc8a8a\"\n  ) +\n  geom_segment(aes(x = -2, y = 20, xend = -2, yend = 10),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#fc8a8a\"\n  ) +\n  annotate(\"text\",\n    x = 6, y = 11.3, label = \"tau\",\n    col = \"#f2e5a9\", parse = TRUE, size = 5\n  ) +\n  annotate(\"text\",\n    x = 5, y = 17.5, label = \"delta\",\n    col = \"#a7d6ac\", parse = TRUE, size = 5\n  ) +\n  geom_segment(aes(x = 6, y = 13, xend = 6, yend = 22),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#a7d6ac\"\n  ) +\n  geom_segment(aes(x = 6, y = 22, xend = 6, yend = 13),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#a7d6ac\"\n  ) +\n  geom_segment(aes(x = 6, y = 11, xend = 6, yend = 10),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#f2e5a9\"\n  ) +\n  theme(axis.title = element_blank())\n\n\n\n\n\nSTP trajectory with parameters.\n\n\n\n\n\nThe forest attribute is first disturbed at \\(t=0\\) with either an increase or a decrease depending on the parameter \\(dist\\). Then the attributes recover asymptotically in the long term to an equilibrium value \\(\\theta_{Inf}\\) with a recovery rate \\(\\lambda\\). But in this second version the recovery trajectory can also accommodate a short term increase of decrease of the attribute at a time \\(\\tau\\) with an intensity \\(\\delta\\).\n\n\n\nCode\nbounds &lt;- read_sheet(\"https://docs.google.com/spreadsheets/d/1rZZ_dKebVp1RnxI0ZawaSQws72FhubuPZ8O27DzJtFE/edit?usp=sharing\") # nolint\nwrite_tsv(bounds, \"data/derived_data/bounds.tsv\")\n\n\n\n\nCode\nread_tsv(\"data/derived_data/bounds.tsv\") %&gt;%\n  mutate(\n    mu_thetaInf = paste0(\"[\", mu_thetaInf_min, \" ,\", mu_thetaInf_max, \"]\"),\n    thetaInf = paste0(\"[\", thetaInf_min, \" ,\", thetaInf_max, \"]\"),\n    lambda = paste0(\"[\", lambda_min, \" ,\", lambda_max, \"]\"),\n    dist = paste0(\"[\", dist_min, \" ,\", dist_max, \"]\"),\n    delta = paste0(\"[\", delta_min, \" ,\", delta_max, \"]\"),\n    tau = paste0(\"[\", tau_min, \" ,\", tau_max, \"]\")\n    ) %&gt;%\n  select(attribute, mu_thetaInf, thetaInf, lambda, dist, delta, tau) %&gt;%\n  kable(caption = \"Parameters boundaries per attribute.\")\n\n\n\nParameters boundaries per attribute.\n\n\n\n\n\n\n\n\n\n\n\nattribute\nmu_thetaInf\nthetaInf\nlambda\ndist\ndelta\ntau\n\n\n\n\nnstem\n[100 ,1000]\n[50 ,2000]\n[0 ,0.5]\n[0.1 ,1]\n[0 ,5]\n[2 ,30]\n\n\nagb\n[100 ,500]\n[50 ,1000]\n[0 ,0.5]\n[0.1 ,1]\n[0 ,5]\n[2 ,30]\n\n\nWD_cwm_ba\n[0.5 ,1.3]\n[0.5 ,1.3]\n[0 ,0.5]\n[0.1 ,1.5]\n[0 ,2]\n[2 ,30]\n\n\nFDiv\n[0 ,1]\n[0 ,1]\n[0 ,0.5]\n[0.1 ,1.5]\n[0 ,2]\n[2 ,30]\n\n\ndiversity_q1_gen\n[10 ,100]\n[10 ,100]\n[0 ,0.5]\n[0.1 ,1.5]\n[0 ,2]\n[2 ,30]\n\n\ngini\n[0 ,2]\n[0 ,2]\n[0 ,0.5]\n[0.1 ,1.5]\n[0 ,2]\n[2 ,30]\n\n\nba\n[1 ,100]\n[1 ,100]\n[0 ,0.5]\n[0.1 ,1]\n[0 ,5]\n[2 ,30]\n\n\nFEve\n[0 ,1]\n[0 ,1]\n[0 ,0.5]\n[0.1 ,1.5]\n[0 ,2]\n[2 ,30]\n\n\nSLA_cwm_ba\n[1 ,50]\n[1 ,50]\n[0 ,0.5]\n[0.1 ,1.5]\n[0 ,2]\n[2 ,30]\n\n\nN_cwm_ba\n[10 ,50]\n[10 ,50]\n[0 ,0.5]\n[0.1 ,1.5]\n[0 ,2]\n[2 ,30]\n\n\nhmax_cwm_ba\n[30 ,60]\n[30 ,60]\n[0 ,0.5]\n[0.1 ,1.5]\n[0 ,2]\n[2 ,30]\n\n\n\n\n\n\n\nCode\nltp &lt;- cmdstan_model(\"models/ltp.stan\")\nstp &lt;- cmdstan_model(\"models/stp.stan\")\nvars &lt;- c(\n  \"nstem\", \"agb\", \"WD_cwm_ba\", \"FDiv\", \"diversity_q1_gen\", \"gini\",\n  \"ba\", \"FEve\", \"SLA_cwm_ba\", \"N_cwm_ba\", \"hmax_cwm_ba\"\n)\nfor (var in vars) {\n  sample_model(var, \"ltp\")\n}\nfor (var in vars) {\n  sample_model(var, \"stp\")\n}"
  },
  {
    "objectID": "31_stem.html#data",
    "href": "31_stem.html#data",
    "title": "Stem",
    "section": "Data",
    "text": "Data\n\n\nCode\nvar &lt;- \"nstem\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- expression(\"Stem [ trees\" ~ ha^{\n  -1\n} ~ \"]\")\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "31_stem.html#ltp",
    "href": "31_stem.html#ltp",
    "title": "Stem",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       2276.44 2275.98 19.23 19.27 2246.46 2307.99 1.01      377      449\n mu_dist       0.80    0.80  0.02  0.02    0.76    0.84 1.01      387     1237\n sigma_dist    0.09    0.08  0.01  0.01    0.07    0.11 1.00     1709     2934\n dist_p[1]     0.80    0.80  0.07  0.06    0.68    0.89 1.00     1750     2478\n dist_p[2]     0.88    0.88  0.06  0.07    0.77    0.98 1.00     1528     1219\n dist_p[3]     0.78    0.78  0.05  0.05    0.68    0.86 1.00     1972     2153\n dist_p[4]     0.81    0.81  0.07  0.06    0.70    0.91 1.00     1846     1914\n dist_p[5]     0.78    0.79  0.06  0.05    0.69    0.87 1.00     1927     2098\n dist_p[6]     0.83    0.83  0.05  0.05    0.74    0.92 1.00     1609     1181\n dist_p[7]     0.83    0.83  0.06  0.06    0.72    0.94 1.00     1474     1126\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "31_stem.html#stp",
    "href": "31_stem.html#stp",
    "title": "Stem",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       2688.65 2688.39 23.74 22.74 2649.07 2729.02 1.00      441      545\n mu_dist       0.74    0.74  0.02  0.02    0.71    0.78 1.00     1009     2126\n sigma_dist    0.10    0.09  0.01  0.01    0.07    0.12 1.00     3049     3219\n dist_p[1]     0.71    0.71  0.04  0.04    0.63    0.78 1.00     4136     3044\n dist_p[2]     0.87    0.86  0.06  0.06    0.78    0.96 1.00     2645     1808\n dist_p[3]     0.73    0.73  0.04  0.04    0.66    0.80 1.00     4100     3163\n dist_p[4]     0.73    0.73  0.05  0.05    0.66    0.81 1.00     4952     2477\n dist_p[5]     0.74    0.74  0.04  0.04    0.67    0.81 1.00     3857     3120\n dist_p[6]     0.81    0.81  0.05  0.05    0.74    0.89 1.00     2721     2075\n dist_p[7]     0.77    0.77  0.05  0.04    0.70    0.85 1.00     3729     2391\n\n # showing 10 of 10026 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "31_stem.html#comparison",
    "href": "31_stem.html#comparison",
    "title": "Stem",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models."
  },
  {
    "objectID": "32_wd.html#data",
    "href": "32_wd.html#data",
    "title": "WD",
    "section": "Data",
    "text": "Data\n\n\nCode\nvar &lt;- \"WD_cwm_ba\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- expression(\"WD [ g\" ~ cm^{\n  -3\n} ~ \"]\")\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "32_wd.html#ltp",
    "href": "32_wd.html#ltp",
    "title": "WD",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       4899.02 4897.02 46.03 49.18 4830.01 4982.04 1.08       48       55\n mu_dist       0.97    0.97  0.00  0.01    0.96    0.98 1.06       41      155\n sigma_dist    0.03    0.03  0.00  0.00    0.02    0.03 1.08       30       88\n dist_p[1]     1.01    1.01  0.02  0.02    0.98    1.03 1.11       25      110\n dist_p[2]     0.96    0.96  0.01  0.01    0.94    0.98 1.04       73      427\n dist_p[3]     1.01    1.01  0.01  0.01    0.99    1.04 1.04      625      962\n dist_p[4]     0.98    0.98  0.01  0.01    0.96    1.00 1.03      724     1045\n dist_p[5]     0.98    0.98  0.01  0.01    0.96    1.00 1.06      485      516\n dist_p[6]     0.99    0.99  0.02  0.02    0.96    1.02 1.13       19       23\n dist_p[7]     0.99    0.99  0.01  0.01    0.97    1.01 1.02      318     1201\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "32_wd.html#stp",
    "href": "32_wd.html#stp",
    "title": "WD",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median    sd    mad      q5     q95 rhat ess_bulk ess_tail\n lp__       4689.96 4698.18 80.05 107.54 4574.35 4791.58 2.10        5       32\n mu_dist       1.02    1.03  0.02   0.02    0.99    1.05 2.05        5       25\n sigma_dist    0.04    0.04  0.01   0.01    0.03    0.06 1.31        9       38\n dist_p[1]     1.07    1.07  0.02   0.02    1.04    1.10 1.06       48      986\n dist_p[2]     0.99    0.99  0.02   0.02    0.96    1.02 1.06       51     1405\n dist_p[3]     1.06    1.06  0.02   0.02    1.04    1.09 1.06       49      788\n dist_p[4]     1.04    1.04  0.02   0.02    1.01    1.08 1.08       34      213\n dist_p[5]     1.02    1.02  0.02   0.02    0.99    1.05 1.09       30     1052\n dist_p[6]     1.02    1.02  0.02   0.02    1.00    1.05 1.08       31      996\n dist_p[7]     1.04    1.04  0.02   0.02    1.01    1.07 1.08       32      279\n\n # showing 10 of 10026 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories.\n\n\n\n\n\n\nCode\nfit_stp$draws(\"dist_p\") %&gt;%\n  mcmc_intervals() +\n  geom_vline(xintercept = 1)\n\n\n\n\n\ndelta posteriors."
  },
  {
    "objectID": "32_wd.html#comparison",
    "href": "32_wd.html#comparison",
    "title": "WD",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models."
  },
  {
    "objectID": "33_agb.html#data",
    "href": "33_agb.html#data",
    "title": "AGB",
    "section": "Data",
    "text": "Data\n\nWe removed Kibale by setting all its AGB vales to 300.\n\n\n\nCode\nvar &lt;- \"agb\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- expression(\"AGB [ t\" ~ ha^{\n  -1\n} ~ \"]\")\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "33_agb.html#ltp",
    "href": "33_agb.html#ltp",
    "title": "AGB",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       2866.55 2867.34 14.24 14.23 2842.09 2888.85 1.01     1018     1812\n mu_dist       0.57    0.57  0.03  0.02    0.53    0.61 1.00     4130     3578\n sigma_dist    0.13    0.13  0.02  0.02    0.10    0.16 1.00     3511     2928\n dist_p[1]     0.51    0.51  0.03  0.03    0.47    0.56 1.00     4364     2549\n dist_p[2]     0.72    0.72  0.03  0.03    0.67    0.76 1.00     2727     3223\n dist_p[3]     0.70    0.70  0.05  0.05    0.61    0.77 1.00     4814     2070\n dist_p[4]     0.70    0.70  0.06  0.06    0.59    0.79 1.00     5569     3161\n dist_p[5]     0.68    0.68  0.03  0.03    0.64    0.72 1.00     2993     3138\n dist_p[6]     0.83    0.83  0.06  0.05    0.73    0.92 1.00     3788     2603\n dist_p[7]     0.82    0.82  0.05  0.05    0.73    0.91 1.00     4278     2727\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "33_agb.html#stp",
    "href": "33_agb.html#stp",
    "title": "AGB",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       2981.07 2971.62 45.76 46.38 2917.25 3060.79 1.47        7       35\n mu_dist       0.61    0.61  0.03  0.03    0.56    0.67 1.16       17       71\n sigma_dist    0.14    0.14  0.02  0.02    0.11    0.18 1.00     2457     2876\n dist_p[1]     0.51    0.51  0.03  0.03    0.47    0.55 1.01     1972     2575\n dist_p[2]     0.66    0.68  0.08  0.07    0.50    0.75 1.01      319     1196\n dist_p[3]     0.70    0.70  0.04  0.04    0.62    0.76 1.00     2583     1710\n dist_p[4]     0.67    0.69  0.08  0.06    0.52    0.77 1.02      485     1065\n dist_p[5]     0.68    0.68  0.03  0.03    0.64    0.72 1.00     1195     1725\n dist_p[6]     0.82    0.82  0.05  0.05    0.74    0.91 1.00     3190     2098\n dist_p[7]     0.82    0.82  0.05  0.05    0.74    0.90 1.00     2404     1763\n\n # showing 10 of 10026 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories.\n\n\n\n\n\n\nCode\nfit_stp$summary(\"lambda_p\", \"mean\") %&gt;%\n  mutate(t95 = log(20) / mean) %&gt;%\n  ggplot(aes(t95)) +\n  geom_histogram() +\n  theme_bw() +\n  scale_x_log10()\n\n\n\n\n\n95% recovery time."
  },
  {
    "objectID": "33_agb.html#comparison",
    "href": "33_agb.html#comparison",
    "title": "AGB",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models.\n\n\n\n\n\n\n\n\nRéjou-Méchain, Maxime, Ariane Tanguy, Camille Piponiot, Jérôme Chave, and Bruno Hérault. 2017. “Biomass: An r Package for Estimating Above-Ground Biomass and Its Uncertainty in Tropical Forests.” Edited by Sarah Goslee. Methods in Ecology and Evolution 8 (9): 1163–67. https://doi.org/10.1111/2041-210x.12753."
  },
  {
    "objectID": "34_fdiv.html#data",
    "href": "34_fdiv.html#data",
    "title": "FDiv",
    "section": "Data",
    "text": "Data\n\n\nCode\nvar &lt;- \"FDiv\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- expression(\"FDiv\")\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "34_fdiv.html#ltp",
    "href": "34_fdiv.html#ltp",
    "title": "FDiv",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       3084.96 3084.08 32.74 31.50 3033.10 3139.53 1.05       98      120\n mu_dist       1.02    1.02  0.01  0.01    1.00    1.05 1.00     1685     1896\n sigma_dist    0.09    0.09  0.01  0.01    0.07    0.12 1.00     2141     2265\n dist_p[1]     1.18    1.18  0.06  0.06    1.09    1.28 1.00      967     1525\n dist_p[2]     1.30    1.31  0.11  0.11    1.10    1.46 1.00      469      664\n dist_p[3]     0.93    0.93  0.05  0.05    0.85    1.00 1.00     1272     1620\n dist_p[4]     0.79    0.79  0.04  0.04    0.73    0.85 1.00     1045     1884\n dist_p[5]     0.91    0.91  0.04  0.04    0.84    0.98 1.00     1037     1362\n dist_p[6]     0.84    0.83  0.04  0.04    0.77    0.91 1.00     1139     1562\n dist_p[7]     0.89    0.89  0.05  0.05    0.80    0.98 1.01      827     1436\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "34_fdiv.html#stp",
    "href": "34_fdiv.html#stp",
    "title": "FDiv",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median     sd    mad      q5     q95 rhat ess_bulk\n lp__       2901.41 2908.52 106.15 114.76 2729.95 3057.54 2.76        4\n mu_dist       1.02    1.02   0.03   0.03    0.96    1.07 1.31        9\n sigma_dist    0.14    0.14   0.02   0.02    0.11    0.18 1.11       23\n dist_p[1]     1.32    1.30   0.08   0.08    1.20    1.47 1.17       16\n dist_p[2]     1.38    1.40   0.08   0.08    1.23    1.49 1.05       58\n dist_p[3]     0.95    0.95   0.08   0.09    0.82    1.08 1.52        7\n dist_p[4]     0.92    0.95   0.30   0.43    0.56    1.28 1.74        6\n dist_p[5]     0.95    0.94   0.12   0.16    0.76    1.13 1.74        6\n dist_p[6]     0.83    0.84   0.09   0.09    0.68    0.95 1.60        6\n dist_p[7]     0.83    0.85   0.10   0.08    0.64    0.95 1.31        9\n ess_tail\n       39\n       64\n      175\n      128\n       62\n       93\n      107\n       94\n      109\n      101\n\n # showing 10 of 10026 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "34_fdiv.html#comparison",
    "href": "34_fdiv.html#comparison",
    "title": "FDiv",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models.\n\n\n\n\n\n\n\n\nMouchet, Maud A., Sébastien Villéger, Norman W. H. Mason, and David Mouillot. 2010. “Functional Diversity Measures: An Overview of Their Redundancy and Their Ability to Discriminate Community Assembly Rules.” Functional Ecology 24 (4): 867–76. https://doi.org/10.1111/j.1365-2435.2010.01695.x."
  },
  {
    "objectID": "35_div_q1_gen.html#data",
    "href": "35_div_q1_gen.html#data",
    "title": "Genus diversity 1",
    "section": "Data",
    "text": "Data\n\n\nCode\nvar &lt;- \"diversity_q1_gen\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- expression(\"Genus diversity\" ~ q == 1)\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "35_div_q1_gen.html#ltp",
    "href": "35_div_q1_gen.html#ltp",
    "title": "Genus diversity 1",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       2485.17 2478.00 40.55 36.48 2430.47 2565.00 1.29       11       50\n mu_dist       1.02    1.02  0.03  0.03    0.97    1.07 1.11       24      198\n sigma_dist    0.14    0.14  0.02  0.02    0.11    0.17 1.03       92     2151\n dist_p[1]     1.07    1.06  0.07  0.07    0.96    1.19 1.01     1197     1839\n dist_p[2]     0.76    0.76  0.06  0.05    0.67    0.85 1.01     1101     2302\n dist_p[3]     1.23    1.22  0.08  0.08    1.10    1.37 1.00     1244     1789\n dist_p[4]     0.82    0.82  0.06  0.06    0.73    0.92 1.01      949     1753\n dist_p[5]     1.07    1.06  0.07  0.06    0.96    1.19 1.00     1230     1820\n dist_p[6]     0.91    0.91  0.06  0.06    0.81    1.01 1.01     1097     1911\n dist_p[7]     0.69    0.69  0.06  0.06    0.58    0.78 1.02      261     1924\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "35_div_q1_gen.html#stp",
    "href": "35_div_q1_gen.html#stp",
    "title": "Genus diversity 1",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median     sd    mad      q5     q95 rhat ess_bulk\n lp__       2191.69 2215.14 134.51 173.43 1995.90 2381.94 2.47        4\n mu_dist       1.00    0.99   0.05   0.06    0.92    1.08 1.42        8\n sigma_dist    0.16    0.16   0.03   0.03    0.12    0.21 1.18       14\n dist_p[1]     1.10    1.10   0.10   0.09    0.96    1.28 1.02      772\n dist_p[2]     0.74    0.74   0.07   0.07    0.63    0.86 1.01     1085\n dist_p[3]     1.27    1.27   0.11   0.11    1.10    1.45 1.02      620\n dist_p[4]     0.83    0.82   0.08   0.07    0.71    0.95 1.02     1186\n dist_p[5]     1.09    1.09   0.09   0.09    0.96    1.27 1.01      579\n dist_p[6]     0.91    0.91   0.08   0.08    0.78    1.04 1.01      965\n dist_p[7]     0.64    0.64   0.08   0.07    0.52    0.77 1.05       60\n ess_tail\n       30\n       90\n       72\n     1179\n     1562\n      871\n     1401\n      137\n     2031\n      127\n\n # showing 10 of 10026 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "35_div_q1_gen.html#comparison",
    "href": "35_div_q1_gen.html#comparison",
    "title": "Genus diversity 1",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models.\n\n\n\n\n\n\n\n\nMarcon, Eric, and Bruno Hérault. 2015. “Entropart: AnRPackage to Measure and Partition Diversity.” Journal of Statistical Software 67 (8). https://doi.org/10.18637/jss.v067.i08."
  },
  {
    "objectID": "37_gini.html#data",
    "href": "37_gini.html#data",
    "title": "Gini",
    "section": "Data",
    "text": "Data\n\n\nCode\nvar &lt;- \"gini\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- \"Gini index\"\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "37_gini.html#ltp",
    "href": "37_gini.html#ltp",
    "title": "Gini",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       4092.50 4092.78 15.18 15.20 4067.03 4116.78 1.00      761     1467\n mu_dist       0.89    0.89  0.01  0.01    0.87    0.91 1.00     2179     2691\n sigma_dist    0.06    0.06  0.01  0.01    0.05    0.07 1.00     4066     3141\n dist_p[1]     0.85    0.85  0.03  0.03    0.80    0.89 1.01     1200     2165\n dist_p[2]     0.92    0.92  0.02  0.02    0.88    0.96 1.01     1084     1496\n dist_p[3]     0.95    0.95  0.03  0.03    0.90    1.01 1.01     1370     1851\n dist_p[4]     1.00    1.00  0.04  0.03    0.94    1.06 1.01      986     2057\n dist_p[5]     0.97    0.96  0.05  0.03    0.92    1.06 1.01      775      720\n dist_p[6]     1.02    1.02  0.04  0.04    0.95    1.08 1.01     1110     1747\n dist_p[7]     0.98    0.98  0.04  0.04    0.92    1.04 1.01     1096     1589\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "37_gini.html#stp",
    "href": "37_gini.html#stp",
    "title": "Gini",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       3645.72 3671.82 96.16 68.79 3473.10 3769.43 1.92        5       34\n mu_dist       0.92    0.92  0.01  0.01    0.90    0.94 1.13       22      143\n sigma_dist    0.06    0.06  0.01  0.01    0.04    0.08 1.05       59     1666\n dist_p[1]     0.86    0.86  0.04  0.04    0.80    0.92 1.01     1930     2608\n dist_p[2]     0.93    0.92  0.03  0.03    0.87    0.98 1.01     2300     1548\n dist_p[3]     0.96    0.95  0.04  0.04    0.90    1.02 1.00     2368     2699\n dist_p[4]     1.00    1.00  0.04  0.05    0.93    1.08 1.01     1931     2449\n dist_p[5]     0.97    0.97  0.05  0.04    0.91    1.06 1.03      180     1657\n dist_p[6]     1.02    1.02  0.05  0.05    0.93    1.09 1.00     1619     1383\n dist_p[7]     0.98    0.98  0.04  0.04    0.91    1.05 1.01     2406     2425\n\n # showing 10 of 10026 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "37_gini.html#comparison",
    "href": "37_gini.html#comparison",
    "title": "Gini",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models."
  },
  {
    "objectID": "38_ba.html#data",
    "href": "38_ba.html#data",
    "title": "BA",
    "section": "Data",
    "text": "Data\n\n\nCode\nvar &lt;- \"ba\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- expression(\"BA [\" ~ m^2 ~ m^{\n  -2\n} ~ \"]\")\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "38_ba.html#ltp",
    "href": "38_ba.html#ltp",
    "title": "BA",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       2566.41 2567.12 14.60 14.22 2541.63 2589.55 1.00      823     1714\n mu_dist       0.61    0.61  0.02  0.02    0.57    0.65 1.00     4561     3419\n sigma_dist    0.13    0.13  0.02  0.02    0.10    0.16 1.00     3608     2853\n dist_p[1]     0.55    0.55  0.04  0.04    0.49    0.62 1.00     4112     2555\n dist_p[2]     0.76    0.76  0.04  0.04    0.69    0.83 1.00     2741     2699\n dist_p[3]     0.71    0.71  0.06  0.05    0.62    0.80 1.00     4084     2593\n dist_p[4]     0.69    0.69  0.07  0.07    0.58    0.80 1.00     4992     2997\n dist_p[5]     0.69    0.69  0.04  0.04    0.63    0.75 1.00     2801     2935\n dist_p[6]     0.83    0.83  0.06  0.06    0.73    0.93 1.00     2297     2017\n dist_p[7]     0.78    0.78  0.07  0.07    0.66    0.90 1.00     3119     1523\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "38_ba.html#stp",
    "href": "38_ba.html#stp",
    "title": "BA",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       2696.42 2696.61 20.01 20.05 2663.66 2728.84 1.01      742     1517\n mu_dist       0.65    0.65  0.03  0.03    0.60    0.70 1.00     2105     2482\n sigma_dist    0.15    0.15  0.02  0.02    0.12    0.18 1.01      879     2127\n dist_p[1]     0.55    0.55  0.04  0.04    0.49    0.61 1.00     2862     2882\n dist_p[2]     0.76    0.76  0.04  0.04    0.69    0.82 1.00     1554     1872\n dist_p[3]     0.72    0.72  0.05  0.05    0.64    0.80 1.00     2602     2495\n dist_p[4]     0.71    0.71  0.05  0.05    0.62    0.79 1.00     2196     2258\n dist_p[5]     0.70    0.70  0.03  0.03    0.64    0.75 1.00     1963     2414\n dist_p[6]     0.85    0.85  0.05  0.06    0.76    0.94 1.00     2258     2111\n dist_p[7]     0.79    0.79  0.06  0.06    0.69    0.89 1.00     2980     1838\n\n # showing 10 of 10026 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "38_ba.html#comparison",
    "href": "38_ba.html#comparison",
    "title": "BA",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models."
  },
  {
    "objectID": "39_feve.html#data",
    "href": "39_feve.html#data",
    "title": "FEve",
    "section": "Data",
    "text": "Data\n\n\nCode\nvar &lt;- \"FEve\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- \"FEve\"\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "39_feve.html#ltp",
    "href": "39_feve.html#ltp",
    "title": "FEve",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       1980.96 1979.44 26.37 26.25 1939.73 2027.31 1.01      219      199\n mu_dist       1.03    1.03  0.03  0.03    0.98    1.07 1.00     1147     2243\n sigma_dist    0.13    0.12  0.02  0.02    0.10    0.16 1.00     1033     1834\n dist_p[1]     1.07    1.07  0.09  0.08    0.94    1.22 1.00     1199      691\n dist_p[2]     1.10    1.09  0.09  0.08    0.97    1.27 1.00     1425     1188\n dist_p[3]     1.10    1.10  0.09  0.08    0.97    1.26 1.00     1454     1031\n dist_p[4]     0.46    0.46  0.07  0.07    0.35    0.60 1.00     1538      543\n dist_p[5]     0.77    0.77  0.08  0.08    0.65    0.90 1.00     1479     2495\n dist_p[6]     1.00    1.00  0.07  0.07    0.88    1.12 1.00     1214      791\n dist_p[7]     1.09    1.09  0.09  0.08    0.96    1.24 1.00     1639     1601\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "39_feve.html#stp",
    "href": "39_feve.html#stp",
    "title": "FEve",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median    sd    mad      q5     q95 rhat ess_bulk ess_tail\n lp__       1763.60 1751.99 92.63 119.76 1640.95 1901.74 2.16        5       36\n mu_dist       1.00    1.00  0.05   0.05    0.92    1.10 1.46        7       29\n sigma_dist    0.16    0.16  0.03   0.03    0.12    0.21 1.24       11      105\n dist_p[1]     0.97    0.98  0.13   0.13    0.74    1.17 1.13       20       91\n dist_p[2]     1.15    1.14  0.13   0.15    0.95    1.34 1.11       24     1399\n dist_p[3]     1.05    1.05  0.11   0.11    0.88    1.25 1.06       41      293\n dist_p[4]     0.41    0.40  0.07   0.05    0.31    0.53 1.06      169     1385\n dist_p[5]     0.69    0.68  0.09   0.09    0.56    0.86 1.05       61     1427\n dist_p[6]     1.00    1.01  0.10   0.10    0.84    1.16 1.06       43     1591\n dist_p[7]     0.99    0.99  0.13   0.14    0.81    1.21 1.14       18      257\n\n # showing 10 of 10026 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "39_feve.html#comparison",
    "href": "39_feve.html#comparison",
    "title": "FEve",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models."
  },
  {
    "objectID": "40_sla.html#data",
    "href": "40_sla.html#data",
    "title": "SLA",
    "section": "Data",
    "text": "Data\n\n\nCode\nvar &lt;- \"SLA_cwm_ba\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- expression(\"SLA [\" ~ mm^2 ~ mg^{\n  -1\n} ~ \"]\")\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "40_sla.html#ltp",
    "href": "40_sla.html#ltp",
    "title": "SLA",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       3957.17 3957.14 14.41 14.55 3933.45 3981.40 1.00      892     1736\n mu_dist       0.96    0.96  0.02  0.02    0.94    0.99 1.00     1131     2237\n sigma_dist    0.08    0.08  0.01  0.01    0.06    0.10 1.00     3794     2618\n dist_p[1]     0.94    0.94  0.03  0.03    0.89    0.98 1.00      785     2078\n dist_p[2]     1.03    1.03  0.06  0.08    0.95    1.13 1.00      684     2392\n dist_p[3]     0.98    0.98  0.03  0.03    0.93    1.03 1.00      753     2253\n dist_p[4]     0.97    0.97  0.03  0.03    0.92    1.01 1.00      763     2462\n dist_p[5]     1.05    1.06  0.03  0.03    1.00    1.11 1.00      829     2333\n dist_p[6]     1.13    1.13  0.03  0.03    1.08    1.18 1.00      828     2785\n dist_p[7]     1.07    1.07  0.03  0.03    1.01    1.12 1.00      818     2312\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "40_sla.html#stp",
    "href": "40_sla.html#stp",
    "title": "SLA",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median     sd    mad      q5     q95 rhat ess_bulk\n lp__       3792.61 3892.06 280.23 221.05 3328.34 4061.67 2.10        5\n mu_dist       0.97    0.97   0.03   0.03    0.92    1.01 1.54        7\n sigma_dist    0.09    0.09   0.02   0.02    0.07    0.12 1.18       15\n dist_p[1]     0.93    0.93   0.04   0.05    0.86    0.99 1.09       29\n dist_p[2]     1.02    1.04   0.09   0.10    0.88    1.14 1.18       17\n dist_p[3]     0.97    0.97   0.05   0.05    0.90    1.05 1.10       27\n dist_p[4]     0.96    0.96   0.04   0.05    0.89    1.03 1.09       31\n dist_p[5]     1.05    1.05   0.05   0.05    0.97    1.12 1.10       26\n dist_p[6]     1.13    1.13   0.05   0.05    1.05    1.20 1.09       30\n dist_p[7]     1.06    1.06   0.05   0.05    0.98    1.13 1.10       27\n ess_tail\n       36\n       35\n       95\n      253\n      109\n      189\n      240\n      153\n      412\n      237\n\n # showing 10 of 10026 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "40_sla.html#comparison",
    "href": "40_sla.html#comparison",
    "title": "SLA",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models."
  },
  {
    "objectID": "41_n.html#data",
    "href": "41_n.html#data",
    "title": "N",
    "section": "Data",
    "text": "Data\n\n\nCode\nvar &lt;- \"N_cwm_ba\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- expression(\"N [\" ~ mg ~ g^{\n  -1\n} ~ \"]\")\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "41_n.html#ltp",
    "href": "41_n.html#ltp",
    "title": "N",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       4584.07 4582.75 26.22 26.78 4544.55 4629.59 1.01      201      256\n mu_dist       0.99    0.99  0.01  0.01    0.97    1.00 1.00     1417     1839\n sigma_dist    0.05    0.05  0.01  0.01    0.04    0.06 1.00     2407     1802\n dist_p[1]     0.98    0.98  0.02  0.02    0.95    1.01 1.00     1333     2312\n dist_p[2]     1.03    1.03  0.02  0.02    1.00    1.06 1.00     1509     2531\n dist_p[3]     0.97    0.97  0.02  0.02    0.94    1.00 1.00     1552     2117\n dist_p[4]     0.95    0.95  0.02  0.02    0.92    0.98 1.00     1389     2415\n dist_p[5]     1.05    1.05  0.02  0.02    1.01    1.08 1.00     1368     2261\n dist_p[6]     0.97    0.97  0.02  0.02    0.94    1.00 1.00     1367     2135\n dist_p[7]     0.95    0.95  0.02  0.02    0.92    0.98 1.00     1358     2467\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "41_n.html#stp",
    "href": "41_n.html#stp",
    "title": "N",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       4694.56 4690.57 49.00 46.12 4620.23 4783.72 1.16       16       46\n mu_dist       0.99    0.99  0.01  0.01    0.97    1.00 1.16       17       62\n sigma_dist    0.05    0.05  0.01  0.01    0.04    0.07 1.01     1873     2932\n dist_p[1]     0.98    0.98  0.02  0.02    0.95    1.01 1.02      234      785\n dist_p[2]     1.03    1.03  0.02  0.02    1.00    1.06 1.01     1641     2346\n dist_p[3]     0.97    0.97  0.02  0.02    0.94    1.00 1.01     1160     2480\n dist_p[4]     0.95    0.95  0.02  0.02    0.92    0.98 1.02      176     2475\n dist_p[5]     1.05    1.05  0.02  0.02    1.01    1.08 1.01     1331      864\n dist_p[6]     0.97    0.97  0.02  0.02    0.94    0.99 1.02      497     2366\n dist_p[7]     0.95    0.95  0.02  0.02    0.92    0.98 1.01      589     2139\n\n # showing 10 of 10026 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "41_n.html#comparison",
    "href": "41_n.html#comparison",
    "title": "N",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models."
  },
  {
    "objectID": "42_hmax.html#data",
    "href": "42_hmax.html#data",
    "title": "hmax",
    "section": "Data",
    "text": "Data\n\n\nCode\nvar &lt;- \"hmax_cwm_ba\"\nif (!exists(file.path(\"chains\", var))) {\n  dir.create(file.path(\"chains\", var))\n}\nlab &lt;- expression(\"hmax [\" ~ m ~ \"]\")\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\") %&gt;%\n  filter(variable == var)\ndata_pre &lt;- read_tsv(\"data/derived_data/data_pre.tsv\") %&gt;%\n  filter(variable == var)\ndata_old &lt;- read_tsv(\"data/derived_data/data_old.tsv\") %&gt;%\n  filter(variable == var)\n\n\n\n\nCode\nbind_rows(data_rec, data_pre, data_old) %&gt;%\n  ggplot(aes(rel_year, y, group = paste(site, plot), col = treatment)) +\n  geom_line() +\n  facet_wrap(~site) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(lab) +\n  theme(legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\nModelled trajectories."
  },
  {
    "objectID": "42_hmax.html#ltp",
    "href": "42_hmax.html#ltp",
    "title": "hmax",
    "section": "LTP",
    "text": "LTP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"ltp\")\nfit_ltp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_ltp\n\n\n   variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__       4953.59 4953.66 18.42 18.05 4923.40 4983.63 1.01      403     1105\n mu_dist       0.99    0.99  0.01  0.01    0.98    1.00 1.00     2282     2769\n sigma_dist    0.03    0.03  0.01  0.01    0.02    0.04 1.00     3620     3071\n dist_p[1]     1.02    1.02  0.01  0.01    1.00    1.04 1.00     1930     2284\n dist_p[2]     1.02    1.02  0.01  0.01    1.00    1.05 1.00     2031     2561\n dist_p[3]     0.99    0.99  0.01  0.01    0.97    1.01 1.00     1967     2346\n dist_p[4]     0.96    0.96  0.01  0.01    0.94    0.98 1.00     2320     2637\n dist_p[5]     0.98    0.97  0.01  0.01    0.95    1.00 1.00     2079     2693\n dist_p[6]     1.00    1.00  0.01  0.01    0.98    1.02 1.00     2133     2722\n dist_p[7]     1.00    1.00  0.01  0.01    0.98    1.03 1.00     1963     2090\n\n # showing 10 of 9054 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_ltp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_ltp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "42_hmax.html#stp",
    "href": "42_hmax.html#stp",
    "title": "hmax",
    "section": "STP",
    "text": "STP\n\n\nCode\npath &lt;- file.path(\"chains\", var, \"stp\")\nfit_stp &lt;- as_cmdstan_fit(list.files(path, full.names = TRUE))\nfit_stp\n\n\n   variable    mean  median     sd    mad      q5     q95 rhat ess_bulk\n lp__       4784.16 4828.02 139.99 115.83 4540.27 4954.64 2.49        4\n mu_dist       1.00    1.00   0.01   0.01    0.99    1.01 1.21       13\n sigma_dist    0.04    0.04   0.01   0.01    0.03    0.05 1.33        9\n dist_p[1]     1.02    1.02   0.02   0.02    0.99    1.05 1.04       77\n dist_p[2]     1.03    1.03   0.02   0.02    0.99    1.06 1.05       63\n dist_p[3]     0.99    0.99   0.02   0.02    0.96    1.02 1.02      497\n dist_p[4]     0.96    0.96   0.02   0.02    0.93    0.99 1.01     1317\n dist_p[5]     0.97    0.97   0.02   0.02    0.95    1.00 1.02     2062\n dist_p[6]     1.00    1.00   0.02   0.02    0.97    1.03 1.03      108\n dist_p[7]     1.01    1.01   0.02   0.02    0.98    1.04 1.04       69\n ess_tail\n       37\n       62\n       34\n      454\n     1562\n     1558\n     1120\n      597\n      961\n      299\n\n # showing 10 of 10026 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data_rec, data_pre, fit_stp)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data_rec, data_pre, data_old, fit_stp, lab)\n\n\n\n\n\nPredicted trajectories."
  },
  {
    "objectID": "42_hmax.html#comparison",
    "href": "42_hmax.html#comparison",
    "title": "hmax",
    "section": "Comparison",
    "text": "Comparison\n\n\nCode\ncomp_lambda_fig(data_rec, fit_ltp, fit_stp)\n\n\n\n\n\nlambda comparison across models.\n\n\n\n\n\n\n\n\nMolto, Q., B. Hérault, J.-J. Boreux, M. Daullet, A. Rousteau, and V. Rossi. 2014. “Predicting Tree Heights for Biomass Estimates in Tropical Forests  a Test from French Guiana.” Biogeosciences 11 (12): 3121–30. https://doi.org/10.5194/bg-11-3121-2014."
  },
  {
    "objectID": "91_stp_negative.html",
    "href": "91_stp_negative.html",
    "title": "STP negatives",
    "section": "",
    "text": "Using long term and short term processes model based on initial value \\(\\theta_0\\) we had issue with negatives values of \\(\\mu_{rec}\\) resulting in impossible log-values:\n\\[\n\\begin{align}\n\\mu_{rec} = \\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times (LTP+STP) \\\\\nLTP = 1 - e^{-\\lambda_p \\times time} \\\\\nSTP = \\delta_p \\times (\\frac{time}{\\tau_s} \\times e^{1-\\frac{time}{\\tau_s}})^2\n\\end{align}\n\\]\nNegatives values happen when the trajectory is negative and the difference of \\(\\theta\\) and the bump fall below 0, so when \\(time=\\tau\\):\n\\[\n\\begin{align}\n\\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times (1 - e^{-\\lambda_p \\times \\tau_s}+\\delta_p) \\leq 0\\\\\n\\end{align}\n\\]\nEn \\(\\lambda_p=0.5\\) et \\(\\tau_s=30\\) , \\(LTP = 1-e^{-0.5*30} \\approx 1\\), thus:\n\\[\n\\begin{align}\n\\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times (1+\\delta_p) \\leq 0\\\\\n\\theta_{\\infty,s} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times \\delta_p \\leq 0\\\\\n\\delta_p \\geq \\frac{-\\theta_{\\infty,s}}  {\\theta_{\\infty,s} - \\theta_{0,p}} ~|~ \\theta_{\\infty,s} - \\theta_{0,p} &lt; 0 \\\\\n\\delta_p \\geq \\frac{-1}  {1 - dist_p} ~|~\\theta_{0,p}=dist_p\\times\\theta_{\\infty,s} \\\\\n\\delta_p \\geq \\frac{1}  {dist_p-1}\n\\end{align}\n\\]\nWe could thus use this inequality to constrain \\(\\delta_p\\) on \\(dist_p\\) knowing that stan now accepts parameters bounds to depend on another parameter. However, this is complicated as it depends on the sign in the division above, \\(dist=1\\) is no possible, and near 1 values results in positive or negative infinite values. Thus we simply bounded \\(dist_p\\) to 1.5 for now (50% gain of attribute post-disturbance).\n\n\nCode\nmodel &lt;- function(time, dist, thetainf, lambda, tau, delta) {\n  theta0 &lt;- thetainf * dist\n  ltp &lt;- 1 - exp(-lambda * time)\n  stp &lt;- delta * (time / tau * exp(1 - time / tau))^2\n  return(theta0 + (thetainf - theta0) * (ltp + stp))\n}\ndata.frame(time = 1:50) %&gt;%\n  mutate(y = model(time,\n    dist = 2, thetainf = 20,\n    lambda = 0.5, tau = 30, delta = 0.5\n  )) %&gt;%\n  mutate(y2 = model(time,\n    dist = 2, thetainf = 20,\n    lambda = 0.5, tau = 30, delta = 2\n  )) %&gt;%\n  mutate(y3 = model(time,\n    dist = 2, thetainf = 20,\n    lambda = 0.5, tau = 30, delta = 1\n  )) %&gt;%\n  ggplot(aes(time)) +\n  geom_line(aes(y = y, col = \"dist=2, delta=.5\")) +\n  geom_line(aes(y = y2, col = \"dist=2, delta=2\")) +\n  geom_line(aes(y = y3, col = \"dist=2, delta=1\")) +\n  theme_bw()\n\n\n\n\n\nNegative STR examples with delta-dist link.\n\n\n\n\n\n\nCode\ndata.frame(dist = seq(.5, 2, length.out = 100)) %&gt;%\n  mutate(delta_max = 2 - (1 / (dist - 1))) %&gt;%\n  ggplot(aes(dist, delta_max)) +\n  geom_line() +\n  theme_bw()\n\n\n\n\n\ndelta_max with dist."
  },
  {
    "objectID": "92_model_devs.html#stp-sum",
    "href": "92_model_devs.html#stp-sum",
    "title": "Models devs",
    "section": "STP sum",
    "text": "STP sum\nmodels/stp_sum.stan\n\\[\n\\begin{align}\n\\mu_{rec} = \\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times (LTP+STP) \\\\\nLTP = 1 - e^{-\\lambda_p \\times time} \\\\\nSTP = \\delta_p \\times (\\frac{time}{\\tau_s} \\times e^{1-\\frac{time}{\\tau_s}})^2 \\\\\n\\theta_{0,p} = \\theta_{\\infty,s} \\times dist_p\n\\end{align}\n\\]"
  },
  {
    "objectID": "92_model_devs.html#stp-lognormal",
    "href": "92_model_devs.html#stp-lognormal",
    "title": "Models devs",
    "section": "STP lognormal",
    "text": "STP lognormal\nmodels/stp.stan\n\\[\n\\begin{align}\n\\mu_{rec} = \\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times (LTP+STP) \\\\\nLTP = 1 - e^{-\\lambda_p \\times time} \\\\\nSTP = \\delta_p \\times (\\frac{time}{\\tau_s} \\times e^{1-\\frac{time}{\\tau_s}})^2 \\\\\n\\theta_{0,p} = \\theta_{\\infty,s} \\times dist_p\n\\end{align}\n\\]"
  },
  {
    "objectID": "92_model_devs.html#stp-correlated",
    "href": "92_model_devs.html#stp-correlated",
    "title": "Models devs",
    "section": "STP correlated",
    "text": "STP correlated\nmodels/stp_cor.stan\nImposed variance-covariance matrix on dist_p and delta_p.\n\\[\n\\begin{align}\n\\mu_{rec} = \\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times (LTP+STP) \\\\\nLTP = 1 - e^{-\\lambda_p \\times time} \\\\\nSTP = \\delta_p \\times (\\frac{time}{\\tau_s} \\times e^{1-\\frac{time}{\\tau_s}})^2 \\\\\n\\theta_{0,p} = \\theta_{\\infty,s} \\times dist_p\n\\end{align}\n\\]"
  },
  {
    "objectID": "92_model_devs.html#parrallel",
    "href": "92_model_devs.html#parrallel",
    "title": "Models devs",
    "section": "Parrallel",
    "text": "Parrallel\ndummy_par.stan"
  },
  {
    "objectID": "93_notes.html#section",
    "href": "93_notes.html#section",
    "title": "Notes",
    "section": "24/01/24",
    "text": "24/01/24\nSections are randomly ordered.\n\nData preparation\nSLA and LA should be logged in species functional trait preparation and SLA inverted in LMA. The N fixation and dispersal still needs to be cleaned.\n\n\nModels structure\nWe must use the random effect for control plots by adding thetaInf_p for controls and pre-inventories with only a hyperdistribution on mu_thetaInf and sigma_thetaInf_p (either concatenating or with two likelihoods) and by modifying thetaInfp in the equation (l. 43 & 44 on mu_old and mu_rec).\n\n\nTrajectories\nAdd box plots for prelogging and controls, and plot longer time series from 1 to 60 years with scale transformation for time. The diversity trajectories are not that bad, but may require better data preparation rather than tweaking the model.\n\n\nModel selection\nLOO model selection fails and does not take into account parsimony with the number of parameters. However, the results show that \\(\\lambda\\) is highly correlated between STP and LTP models (e.g. AGB) and the choice may not be necessary or may be made post hoc.\n\n\nDisturbance intensity\n\\(dist_p\\) can represent the intensity of disturbance for attributes where it is well modelled (to be verified with data where possible) to provide information after the HDI on diversity trajectories. Sequential inference problem (uncertainty transmission?) or joint but with influence of diversity trajectory back on \\(dist_p\\). Camille proposes to use a hyperdistribution on \\(dist_p\\), informed with harvested volumes if available.\n\n\nOnline workshop\n3-4 sessions with :\n\nGeneral session on Thursday, a quick introduction to data preparation including environment and species, model development, re-introduction to the model with a quick focus on the constrained disturbance index.\nSubgroup session on Thursday, where subgroups make a first exploration of preliminary parameters for their question of interest with associated covariates.\nGeneral session on Friday where sub-groups present their results.\nOptional subgroup session on Friday if they wish.\n\nWe need to prepare for this:\n\nTrajectory attributes: agb, gini, stem, ba, hill q1 genus index, FDiv, Feve, CWM wd, lma, n, hmax.\nAutomatic rmarkdown pdf report for PIs (no pages yet): agb, gini, stem, ba, hill q1 genus index, FDiv, CWM wd, lma, hmax.\nUpdate Mithila Monday afternoon\nPrepare subgroup data and figures for Wednesday (all parameters with fifth usual quantiles, derived parameter \\(t_{95}\\), associated environmental data with description, maybe some graphs).\n\n\n\nSubgroup 3\nMuch remains to be explored, Sylvain’s offers punctual help on theoretical development in sessions with Géraldine and Camille."
  },
  {
    "objectID": "99_references.html",
    "href": "99_references.html",
    "title": "References",
    "section": "",
    "text": "Marcon, Eric, and Bruno Hérault. 2015.\n“Entropart:\nAnRPackage to Measure and Partition\nDiversity.” Journal of Statistical Software 67 (8). https://doi.org/10.18637/jss.v067.i08.\n\n\nMaurent, Eliott, Bruno Hérault, Camille Piponiot, Géraldine Derroire,\nDiego Delgado, Bryan Finegan, Mélaine Aubry Kientz, Bienvenu H. K.\nAmani, and Marie Ange Ngo Bieng. 2023. “A Common Framework to\nModel Recovery in Disturbed Tropical Forests.” Ecological\nModelling 483 (September): 110418. https://doi.org/10.1016/j.ecolmodel.2023.110418.\n\n\nMolto, Q., B. Hérault, J.-J. Boreux, M. Daullet, A. Rousteau, and V.\nRossi. 2014. “Predicting Tree Heights for Biomass Estimates in\nTropical Forests  a Test from French Guiana.”\nBiogeosciences 11 (12): 3121–30. https://doi.org/10.5194/bg-11-3121-2014.\n\n\nMouchet, Maud A., Sébastien Villéger, Norman W. H. Mason, and David\nMouillot. 2010. “Functional Diversity Measures: An Overview of\nTheir Redundancy and Their Ability to Discriminate Community Assembly\nRules.” Functional Ecology 24 (4): 867–76. https://doi.org/10.1111/j.1365-2435.2010.01695.x.\n\n\nRéjou-Méchain, Maxime, Ariane Tanguy, Camille Piponiot, Jérôme Chave,\nand Bruno Hérault. 2017. “Biomass: An r Package for Estimating\nAbove-Ground Biomass and Its Uncertainty in Tropical\nForests.” Edited by Sarah Goslee. Methods in Ecology and\nEvolution 8 (9): 1163–67. https://doi.org/10.1111/2041-210x.12753."
  }
]