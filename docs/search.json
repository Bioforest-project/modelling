[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "modelling",
    "section": "",
    "text": "Introduction\nmodelling is a sub-project of the BioForest project aimed at species related data (correct names, functional traits, phylogeny) as part of the data preparation for data preparation within the project."
  },
  {
    "objectID": "index.html#usage",
    "href": "index.html#usage",
    "title": "modelling",
    "section": "Usage",
    "text": "Usage\nAll modelling analyses rely on the quarto documents (files.qmd) that can be run with R and associated environment defined with renv."
  },
  {
    "objectID": "index.html#project",
    "href": "index.html#project",
    "title": "modelling",
    "section": "Project",
    "text": "Project\nmodelling includes:\n\nAnalyse of the data with associated documentation and figures:\n\nReproductive analyses in files.qmd\nResulting pages in docs/\nDocument structure definition in _quarto.yml\n\nAutomatic per site reports for PIs analyses/\nData in data/ with:\n\nAll raw data in raw_data/\nAll derived data in derived_sata/\n\nStan Bayesian models in models/\nStan Bayesian models outputs in chains/\nR scripts with funtions in r/\nIntermediary files in outputs/\nFigures in figures/\nR environment definition with renv in renv/ and renv/lock\nR files (.Rbuildignore , .Rdata , .Rprofile , .Rhistory, .lintr)\nGit and GitHub files (.gitignore , .github/)\nProject documentation (README.qmd , README.md , NEWS.md, LICENSE )"
  },
  {
    "objectID": "index.html#contribution",
    "href": "index.html#contribution",
    "title": "modelling",
    "section": "Contribution",
    "text": "Contribution\nYou can contribute to the project by forking the repository on github and cloning the fork to your machine using several options, including GitHub desktop GUI. Further informations on contribution are detailed in the online document: https://bioforest-project.github.io/data_preparation/98_contributing.html."
  },
  {
    "objectID": "index.html#help",
    "href": "index.html#help",
    "title": "modelling",
    "section": "Help",
    "text": "Help\nPlease preferentially create an issue on GitHub for any questions, bugs or help needed regarding modelling: https://github.com/Bioforest-project/modelling/issues . You may however reach us by mail with people from the core group (see below)."
  },
  {
    "objectID": "index.html#core-group",
    "href": "index.html#core-group",
    "title": "modelling",
    "section": "Core group",
    "text": "Core group\n\nSylvain Schmitt (sylvain.schmitt@cirad.fr)\nCamille Piponiot-Laroche (camille.piponiot-laroche@cirad.fr)\nBruno Hérault (bruno.herault@cirad.fr)\n\nThe whole group consist of participants to the Bioforest project."
  },
  {
    "objectID": "11_data_check.html#metadata",
    "href": "11_data_check.html#metadata",
    "title": "Data check",
    "section": "Metadata",
    "text": "Metadata\n\n\nCode\nlibrary(googlesheets4)\nread_sheet(\"https://docs.google.com/spreadsheets/d/1fq2owxMBLBwwibcdw2uQQFxnIhsMbaH4Qcj_xUwVvSQ/edit?usp=sharing\", 2) %&gt;% # nolint\n  separate_rows(site_raw, sep = \",\") %&gt;%\n  write_tsv(\"data/raw_data/sites.tsv\")\nread_sheet(\"https://docs.google.com/spreadsheets/d/1fq2owxMBLBwwibcdw2uQQFxnIhsMbaH4Qcj_xUwVvSQ/edit?gid=0#gid=0\", col_types = \"c\") %&gt;% # nolint\n  rename_all(tolower) %&gt;%\n  select(site, plot, treatment, year_of_harvest, longitude) %&gt;%\n  write_tsv(\"data/raw_data/metadata.tsv\")\nread_sheet(\"https://docs.google.com/spreadsheets/d/1fq2owxMBLBwwibcdw2uQQFxnIhsMbaH4Qcj_xUwVvSQ/edit?usp=sharing\",\n           \"plot_correspondance\", col_types = \"c\") %&gt;% \n  write_tsv(\"data/raw_data/plot_metadata.tsv\")\nread_sheet(\"https://docs.google.com/spreadsheets/d/1fq2owxMBLBwwibcdw2uQQFxnIhsMbaH4Qcj_xUwVvSQ/edit?usp=sharing\",\n           \"spurious\", col_types = \"c\") %&gt;% \n  na.omit() %&gt;% \n  write_tsv(\"data/raw_data/spurious.tsv\")\n\n\nThe following site names in metadata need to be fixed:\n\n\nCode\nread_tsv(\"data/raw_data/metadata.tsv\") %&gt;%\n  select(site) %&gt;%\n  rename(site_raw = site) %&gt;%\n  unique() %&gt;%\n  left_join(read_tsv(\"data/raw_data/sites.tsv\")) %&gt;%\n  filter(site_raw != site) %&gt;%\n  kable()\n\n\n\n\n\nsite_raw\nsite\n\n\n\n\n\n\n\nThe following treatments are present:\n\n\nCode\ncontrol_names &lt;- c(\"Control\")\nread_tsv(\"data/raw_data/metadata.tsv\") %&gt;%\n  select(treatment) %&gt;%\n  unique() %&gt;%\n  mutate(treatment_simpified = ifelse(treatment %in% control_names,\n    \"control\", \"logged\"\n  )) %&gt;%\n  group_by(treatment_simpified) %&gt;%\n  summarise(treatments = paste(treatment, collapse = \", \")) %&gt;%\n  kable()\n\n\n\n\n\ntreatment_simpified\ntreatments\n\n\n\n\ncontrol\nControl\n\n\nlogged\nLogging\n\n\n\n\n\nThe following sites have non machine readable year of harvest:\n\n\nCode\nread_tsv(\"data/raw_data/metadata.tsv\") %&gt;%\n  select(site, year_of_harvest) %&gt;%\n  unique() %&gt;%\n  na.omit() %&gt;%\n  filter(is.na(as.numeric(year_of_harvest))) %&gt;%\n  kable()\n\n\n\n\n\nsite\nyear_of_harvest"
  },
  {
    "objectID": "11_data_check.html#aggregated-data",
    "href": "11_data_check.html#aggregated-data",
    "title": "Data check",
    "section": "Aggregated data",
    "text": "Aggregated data\nThe following site names in data need to be fixed:\n\n\nCode\nread_csv(aggregated_file) %&gt;%\n  rename_all(tolower) %&gt;%\n  select(site) %&gt;%\n  rename(site_raw = site) %&gt;%\n  unique() %&gt;%\n  left_join(read_tsv(\"data/raw_data/sites.tsv\")) %&gt;%\n  filter(site_raw != site) %&gt;%\n  kable()\n\n\n\n\n\nsite_raw\nsite\n\n\n\n\n\n\n\nMissing values (NA) across variables of interest:\n\n\nCode\nna_data &lt;- read_csv(aggregated_file) %&gt;%\n  rename_all(tolower) %&gt;%\n  rename(site_raw = site) %&gt;%\n  left_join(read_tsv(\"data/raw_data/sites.tsv\")) %&gt;%\n  select(-site_raw) %&gt;%\n  filter(variable %in% vars) %&gt;%\n  filter(is.na(value)) %&gt;%\n  group_by(variable, site) %&gt;%\n  summarise(N = n()) %&gt;%\n  pivot_wider(names_from = variable, values_from = N)\nkable(na_data)\n\n\n\n\n\nsite\n\n\n\n\n\n\n\nInfinite values (Inf) across variables of interest:\n\n\nCode\ninf_data &lt;- read_csv(aggregated_file) %&gt;%\n  rename_all(tolower) %&gt;%\n  rename(site_raw = site) %&gt;%\n  left_join(read_tsv(\"data/raw_data/sites.tsv\")) %&gt;%\n  select(-site_raw) %&gt;%\n  filter(variable %in% vars) %&gt;%\n  filter(is.infinite(value)) %&gt;%\n  group_by(variable, site) %&gt;%\n  summarise(N = n()) %&gt;%\n  pivot_wider(names_from = variable, values_from = N)\nkable(inf_data)\n\n\n\n\n\nsite\n\n\n\n\n\n\n\nZero values across variables of interest:\n\n\nCode\nzero_data &lt;- read_csv(aggregated_file) %&gt;%\n  rename_all(tolower) %&gt;%\n  rename(site_raw = site) %&gt;%\n  left_join(read_tsv(\"data/raw_data/sites.tsv\")) %&gt;%\n  select(-site_raw) %&gt;%\n  filter(variable %in% vars) %&gt;%\n  filter(value == 0) %&gt;%\n  group_by(variable, site) %&gt;%\n  summarise(N = n()) %&gt;%\n  pivot_wider(names_from = variable, values_from = N)\nkable(zero_data)\n\n\n\n\n\nsite\n\n\n\n\n\n\n\nSpurious structure values across variables of interest:\n\n\nCode\nlims &lt;- tribble(\n  ~variable, ~min, ~max,\n  \"ba\", 5, 80,\n  \"agb\", 50, 800,\n  \"nstem\", 50, 1000,\n  \"gini\", 0, 1\n)\nspurious_data_str &lt;- read_csv(aggregated_file) %&gt;%\n  rename_all(tolower) %&gt;%\n  rename(site_raw = site) %&gt;%\n  left_join(read_tsv(\"data/raw_data/sites.tsv\")) %&gt;%\n  select(-site_raw) %&gt;%\n  filter(variable %in% lims$variable) %&gt;%\n  left_join(lims) %&gt;%\n  filter(value &lt; min | value &gt; max) %&gt;%\n  group_by(variable, site) %&gt;%\n  summarise(N = n()) %&gt;%\n  pivot_wider(names_from = variable, values_from = N)\nkable(spurious_data_str)\n\n\n\n\n\nsite\nagb\nba\n\n\n\n\nEmbrapa Acre\n1\n\n\n\nKibale\n118\n4\n\n\nNelliyampathy\n1\n\n\n\n\n\n\nSpurious diversity values across variables of interest:\n\n\nCode\nlims &lt;- tribble(\n  ~variable, ~min, ~max,\n  \"diversity_q1_gen\", 10, 100,\n  \"FDiv\", 0, 1\n)\nspurious_data_div &lt;- read_csv(aggregated_file) %&gt;%\n  rename_all(tolower) %&gt;%\n  rename(site_raw = site) %&gt;%\n  left_join(read_tsv(\"data/raw_data/sites.tsv\")) %&gt;%\n  select(-site_raw) %&gt;%\n  filter(variable %in% lims$variable) %&gt;%\n  left_join(lims) %&gt;%\n  filter(value &lt; min | value &gt; max) %&gt;%\n  group_by(variable, site) %&gt;%\n  summarise(N = n()) %&gt;%\n  pivot_wider(names_from = variable, values_from = N)\nkable(spurious_data_div)\n\n\n\n\n\nsite\ndiversity_q1_gen\n\n\n\n\nEmbrapa Acre\n2\n\n\nIwokrama\n20\n\n\nKabo\n7\n\n\nKibale\n44\n\n\nPeteco\n2\n\n\n\n\n\nSpurious functional values across variables of interest:\n\n\nCode\nlims &lt;- tribble(\n  ~variable, ~min, ~max,\n  \"WD_cwm_ba\", 0, 1,\n  \"SLA_cwm_ba\", 5, 30\n)\nspurious_data_func &lt;- read_csv(aggregated_file) %&gt;%\n  rename_all(tolower) %&gt;%\n  rename(site_raw = site) %&gt;%\n  left_join(read_tsv(\"data/raw_data/sites.tsv\")) %&gt;%\n  select(-site_raw) %&gt;%\n  filter(variable %in% lims$variable) %&gt;%\n  left_join(lims) %&gt;%\n  filter(value &lt; min | value &gt; max) %&gt;%\n  group_by(variable, site) %&gt;%\n  summarise(N = n()) %&gt;%\n  pivot_wider(names_from = variable, values_from = N)\nkable(spurious_data_func)\n\n\n\n\n\nsite\nSLA_cwm_ba\n\n\n\n\nIwokrama\n1\n\n\n\n\n\nAll sites with NA, infinite, zeros or spurious values will be removed for now:\n\n\nCode\nspurious_sites &lt;- bind_rows(\n  na_data %&gt;% select(site),\n  inf_data %&gt;% select(site),\n  zero_data %&gt;% select(site),\n  spurious_data_str %&gt;% select(site)\n  # spurious_data_div %&gt;% select(site), #nolint\n  # spurious_data_func %&gt;% select(site) #nolint\n) %&gt;%\n  unique() %&gt;%\n  arrange() %&gt;%\n  mutate(N = seq_len(n()))\nkable(spurious_sites)\n\n\n\n\n\nsite\nN\n\n\n\n\nEmbrapa Acre\n1\n\n\nKibale\n2\n\n\nNelliyampathy\n3\n\n\n\n\n\nRemaining sites are:\n\n\nCode\nread_csv(aggregated_file) %&gt;%\n  rename_all(tolower) %&gt;%\n  rename(site_raw = site) %&gt;%\n  left_join(read_tsv(\"data/raw_data/sites.tsv\")) %&gt;%\n  select(-site_raw) %&gt;%\n  filter(!(site %in% spurious_sites$site)) %&gt;%\n  select(site) %&gt;%\n  unique() %&gt;%\n  arrange() %&gt;%\n  mutate(N = seq_len(n())) %&gt;%\n  kable()\n\n\n\n\n\nsite\nN\n\n\n\n\nAntimary APU2\n1\n\n\nAntimary APU3\n2\n\n\nBAFOG\n3\n\n\nCorinto\n4\n\n\nEcosilva\n5\n\n\nIracema\n6\n\n\nIwokrama\n7\n\n\nJari\n8\n\n\nJenaro Herrera\n9\n\n\nKabo\n10\n\n\nLesong\n11\n\n\nMalinau\n12\n\n\nManare\n13\n\n\nMbaiki\n14\n\n\nMil\n15\n\n\nMisiones\n16\n\n\nMoju\n17\n\n\nMontagne Tortue\n18\n\n\nPAD Limoeiro Tabocal\n19\n\n\nPad Limo 2 Barracos\n20\n\n\nPad Limo Chico Bocao\n21\n\n\nPad Limo Cumaru\n22\n\n\nPad Limo Jatoba\n23\n\n\nPad Limo Pocao\n24\n\n\nPad Limo STCP\n25\n\n\nParacou\n26\n\n\nPeixoto\n27\n\n\nPeteco\n28\n\n\nSao Nicolau\n29\n\n\nSer Filipinas\n30\n\n\nSTREK\n31\n\n\nSUAS\n32\n\n\nSungai Lalang\n33\n\n\nTapajos Km114\n34\n\n\nTapajos Km67\n35\n\n\nTirimbina\n36\n\n\nUlu Muda\n37\n\n\nUppangala\n38"
  },
  {
    "objectID": "12_data_prep.html",
    "href": "12_data_prep.html",
    "title": "Data prep",
    "section": "",
    "text": "Data exploration.\n\n\nCode\ncontrol_names &lt;- c(\"Control\")\nmetadata &lt;- read_tsv(\"data/raw_data/metadata.tsv\") %&gt;%\n  rename(site_raw = site) %&gt;%\n  left_join(read_tsv(\"data/raw_data/sites.tsv\")) %&gt;%\n  select(-site_raw) %&gt;%\n  separate(year_of_harvest, \"year_of_harvest\") %&gt;%\n  mutate(year_of_harvest = as.numeric(year_of_harvest)) %&gt;%\n  rename(harvest_year = year_of_harvest) %&gt;%\n  mutate(treatment = ifelse(treatment %in% control_names,\n    \"control\", \"logged\"\n  )) %&gt;%\n  group_by(site) %&gt;%\n  mutate(harvest_year_min = min(harvest_year, na.rm = TRUE)) %&gt;%\n  mutate(harvest_year = ifelse(site == \"Paracou\", 1986, harvest_year)) %&gt;%\n  mutate(harvest_year_min = ifelse(site == \"Paracou\", 1986, harvest_year_min))\nvars &lt;- c(\n  \"ba\", \"agb\", \"nstem\", \"gini\",\n  \"diversity_q1_gen\", \"diversity_q1_sp\", \"diversity_q0_gen\", \"diversity_q0_sp\",\n  \"FDiv\",\n  \"WD_cwm_ba\", \"SLA_cwm_ba\"\n)\nsites &lt;- c(\n  \"Antimary APU2\", \"Antimary APU3\", \"BAFOG\", \"Corinto\", \"Ecosilva\", \"Gola\",\n  \"Iracema\", \"Iwokrama\", \"Jari\", \"Jenaro Herrera\", \"Kabo\", \"Kibale\", \"Lesong\",\n  \"Malinau\", \"Manare\", \"Mbaiki\", \"Mil\", \"Misiones\", \"Moju\", \"Montagne Tortue\",\n  \"Nelliyampathy\", \"Pad Limo 2 Barracos\", \"Pad Limo Chico Bocao\",\n  \"Pad Limo Cumaru\",\n  \"Pad Limo Jatoba\", \"Pad Limo Pocao\", \"Pad Limo STCP\", \"Paracou\", \"Peixoto\",\n  \"Peteco\", \"Sao Nicolau\", \"Sungai Lalang\", \"Tapajos Km114\",\n  \"Tapajos Km67\", \"Tirimbina\", \"Ulu Muda\", \"Uppangala\", \"SUAS\"\n)\nantimary_sites &lt;- c(\n  \"Antimary APU2\", \"Antimary APU3\"\n)\npad_sites &lt;- c(\n  \"Pad Limo 2 Barracos\", \"Pad Limo Chico Bocao\", \"Pad Limo Cumaru\",\n  \"Pad Limo Jatoba\", \"Pad Limo Pocao\", \"Pad Limo STCP\"\n)\nspurious &lt;- read_tsv(\"data/raw_data/spurious.tsv\")\ndata &lt;- read_csv(aggregated_file) %&gt;%\n  na.omit() %&gt;%\n  rename_all(tolower) %&gt;%\n  rename(site_raw = site) %&gt;%\n  left_join(read_tsv(\"data/raw_data/sites.tsv\")) %&gt;%\n  select(-site_raw) %&gt;% \n  rename(new_plot = plot) %&gt;% \n  left_join(read_tsv(\"data/raw_data/plot_metadata.tsv\")) %&gt;% \n  left_join(metadata) %&gt;% \n  select(-plot) %&gt;% \n  rename(plot = new_plot, area = new_plot_area) %&gt;% \n  filter(site %in% sites) %&gt;%\n  filter(!(site %in% spurious$site & \n             plot %in% spurious$plot & \n             year %in% spurious$year)) %&gt;% \n  mutate(plot = ifelse(site %in% c(pad_sites, antimary_sites),\n    paste(site, plot),\n    plot\n  )) %&gt;%\n  mutate(site = ifelse(site %in% pad_sites, \"Pad Limo\", site)) %&gt;%\n  mutate(site = ifelse(site %in% antimary_sites, \"Antimary\", site)) %&gt;%\n  filter(variable %in% vars) %&gt;%\n  mutate(rel_year = ifelse(treatment == \"control\",\n    year - harvest_year_min,\n    year - harvest_year\n  )) %&gt;%\n  mutate(y = value) %&gt;%\n  mutate(sitenum = as.numeric(as.factor(site)))\ndata_equ &lt;- data %&gt;%\n  filter((rel_year &lt;= 0 & treatment == \"logged\") | treatment == \"control\") %&gt;%\n  group_by(variable) %&gt;%\n  mutate(plotnum = as.numeric(as.factor(paste(site, plot))))\ndata_rec &lt;- data %&gt;%\n  filter(treatment == \"logged\", rel_year &gt; 2) %&gt;%\n  group_by(variable) %&gt;%\n  mutate(plotnum = as.numeric(as.factor(paste0(site, \"_\", plot))))\nwrite_tsv(data, \"data/derived_data/data.tsv\")\nwrite_tsv(data_rec, \"data/derived_data/data_rec.tsv\")\nwrite_tsv(data_equ, \"data/derived_data/data_equ.tsv\")\n\n\n\n\nCode\nvars &lt;- c(\n  \"ba\", \"agb\", \"nstem\", \"gini\",\n  \"diversity_q1_gen\", \"diversity_q1_sp\", \"diversity_q0_gen\", \"diversity_q0_sp\",\n  \"FDiv\",\n  \"WD_cwm_ba\", \"SLA_cwm_ba\"\n)\nnames(vars) &lt;- vars\nmake_fig &lt;- function(var) {\n  read_tsv(\"data/derived_data/data.tsv\") %&gt;%\n    filter(variable == var) %&gt;%\n    ggplot(aes(year, value, group = paste(site, plot), col = treatment)) +\n    geom_line() +\n    geom_point() +\n    theme_bw() +\n    xlab(\"\") +\n    ylab(\"\") +\n    facet_wrap(~site, scales = \"free\") +\n    geom_vline(aes(xintercept = harvest_year)) +\n    theme(legend.position = \"bottom\")\n}\nlapply(vars, make_fig)\n\n\n$ba\n\n\n\n\n\nTrajectories across sites and treatments.\n\n\n\n\n\n$agb\n\n\n\n\n\nTrajectories across sites and treatments.\n\n\n\n\n\n$nstem\n\n\n\n\n\nTrajectories across sites and treatments.\n\n\n\n\n\n$gini\n\n\n\n\n\nTrajectories across sites and treatments.\n\n\n\n\n\n$diversity_q1_gen\n\n\n\n\n\nTrajectories across sites and treatments.\n\n\n\n\n\n$diversity_q1_sp\n\n\n\n\n\nTrajectories across sites and treatments.\n\n\n\n\n\n$diversity_q0_gen\n\n\n\n\n\nTrajectories across sites and treatments.\n\n\n\n\n\n$diversity_q0_sp\n\n\n\n\n\nTrajectories across sites and treatments.\n\n\n\n\n\n$FDiv\n\n\n\n\n\nTrajectories across sites and treatments.\n\n\n\n\n\n$WD_cwm_ba\n\n\n\n\n\nTrajectories across sites and treatments.\n\n\n\n\n\n$SLA_cwm_ba\n\n\n\n\n\nTrajectories across sites and treatments."
  },
  {
    "objectID": "21_models.html#equilibirum",
    "href": "21_models.html#equilibirum",
    "title": "Models",
    "section": "Equilibirum",
    "text": "Equilibirum\nEquilibrium model using control and pre-logging inventories to inform \\(\\theta\\) prior of the recovery trajectory:\n\\[\n\\begin{align}\ny \\sim \\mathcal N (\\mu_{site}+\\delta_{plot}, \\sigma)\\\\\n\\delta_{plot} \\sim \\mathcal N(0,\\sigma_{plot})\n\\end{align}\n\\]"
  },
  {
    "objectID": "21_models.html#recovery",
    "href": "21_models.html#recovery",
    "title": "Models",
    "section": "Recovery",
    "text": "Recovery\nRecovery trajectory model:\n\\[\n\\begin{align}\nlog(y) \\sim \\mathcal N (log(\\mu), \\sigma)\\\\\n\\mu = \\theta_{site} \\times (\\phi_{plot} + LTP \\times (1 - \\phi_{plot}) + STP) \\\\\nLTP = 1 - e^{-\\lambda_{plot} \\times t} \\\\\nSTP = \\delta_{plot} \\times (\\frac{t}{\\tau_{site}} \\times e^{1-\\frac{t}{\\tau_{site}}})^2 \\\\\n\\lambda_{plot} \\sim \\mathcal N (\\mu_{\\lambda}, \\sigma_{\\lambda})\\\\\n\\tau_{site} \\sim \\mathcal N (\\mu_{\\tau}, \\sigma_{\\tau}) \\\\\n(\\sigma,\\sigma_{\\lambda},\\sigma_{\\tau}) \\sim \\mathcal N^3(0,1) \\\\\n\\theta_{site} \\sim \\mathcal N (mean(y_{control,site}), sd(y_{control,site})) \\\\\n\\phi_{plot} \\sim \\mathcal U(0.1,1.5) \\\\\n\\lambda_{plot} \\sim \\mathcal U(0,0.5) \\\\\n\\delta_{plot} \\sim \\mathcal U(-\\phi_{plot},2) \\\\\n\\tau_{site} \\sim \\mathcal U(5,40)\n\\end{align}\n\\]\nThe model we use is derived from the common framework for modelling recovery in disturbed tropical forests (Maurent et al. 2023). The forest attribute is first disturbed at \\(t=0\\) with either an increase or a decrease depending on the parameter \\(\\phi\\). Then the attributes recover asymptotically in the long term to an equilibrium value \\(\\theta\\) with a recovery rate \\(\\lambda\\). But the recovery trajectory can also accommodate a short term increase of decrease of the attribute at a time \\(\\tau\\) with an intensity \\(\\delta\\).\n\n\nCode\nltp &lt;- function(time, dist, thetainf, lambda) {\n  theta0 &lt;- thetainf * dist\n  ltp &lt;- 1 - exp(-lambda * time)\n  theta0 + (thetainf - theta0) * (ltp)\n}\nstp &lt;- function(time, dist, thetainf, lambda, tau, delta) {\n  theta0 &lt;- thetainf * dist\n  ltp &lt;- 1 - exp(-lambda * time)\n  stp &lt;- delta * (time / tau * exp(1 - time / tau))^2\n  theta0 + ltp * (thetainf - theta0) + stp * thetainf\n}\ndata.frame(time = seq(0.1, 50, length.out = 100)) %&gt;%\n  mutate(y_stp = stp(time,\n    dist = 0.5, thetainf = 20, lambda = 0.05,\n    tau = 5, delta = 0.5\n  )) %&gt;%\n  mutate(y_ltp = ltp(time, dist = 0.5, thetainf = 20, lambda = 0.05)) %&gt;%\n  bind_rows(data.frame(time = 0, y_stp = 20, y_ltp = 20)) %&gt;%\n  ggplot(aes(time)) +\n  geom_line(aes(y = y_ltp), col = \"grey\") +\n  geom_line(aes(y = y_stp)) +\n  theme_bw() +\n  annotate(\"text\",\n    x = 52, y = 19.5, label = \"theta[site]\",\n    col = \"#9ea1d4\", parse = TRUE, size = 5\n  ) +\n  annotate(\"text\",\n    x = 20, y = 15, label = \"lambda[plot]\",\n    col = \"#a8d2d1\", parse = TRUE, size = 5\n  ) +\n  annotate(\"text\",\n    x = -4, y = 15, label = \"phi[plot]\",\n    col = \"#fc8a8a\", parse = TRUE, size = 5\n  ) +\n  theme(axis.title = element_blank()) +\n  geom_segment(aes(x = -2, y = 10, xend = -2, yend = 20),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#fc8a8a\"\n  ) +\n  geom_segment(aes(x = -2, y = 20, xend = -2, yend = 10),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#fc8a8a\"\n  ) +\n  annotate(\"text\",\n    x = 6, y = 9.3, label = \"tau[site]\",\n    col = \"#f2e5a9\", parse = TRUE, size = 5\n  ) +\n  annotate(\"text\",\n    x = 4, y = 17.5, label = \"delta[plot]\",\n    col = \"#a7d6ac\", parse = TRUE, size = 5\n  ) +\n  geom_segment(aes(x = 6, y = 13, xend = 6, yend = 22),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#a7d6ac\"\n  ) +\n  geom_segment(aes(x = 6, y = 22, xend = 6, yend = 13),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#a7d6ac\"\n  ) +\n  geom_segment(aes(x = 6, y = 9, xend = 6, yend = 7),\n    arrow = arrow(length = unit(0.2, \"cm\")), col = \"#f2e5a9\"\n  ) +\n  theme(axis.title = element_blank()) +\n  geom_segment(aes(x = -5, y = 20, xend = 0, yend = 20)) +\n  ylim(7, NA)\n\n\n\n\n\nSTP proj with pars.\n\n\n\n\n\nChoices (to be developed as text in an appendix):\n\nUsing the log of y and a normal distribution centred on log(mu)\nCauchy hyperdist\nForced dist_p&lt;1\nBounds of theta\nFree tau\nFree delta\n\n⚠️ Hump is mathematically opposed to the sign of dist_p-1.\n\n\n\n\n\nMaurent, Eliott, Bruno Hérault, Camille Piponiot, Géraldine Derroire, Diego Delgado, Bryan Finegan, Mélaine Aubry Kientz, Bienvenu H. K. Amani, and Marie Ange Ngo Bieng. 2023. “A Common Framework to Model Recovery in Disturbed Tropical Forests.” Ecological Modelling 483 (September): 110418. https://doi.org/10.1016/j.ecolmodel.2023.110418."
  },
  {
    "objectID": "30_trajectories.html",
    "href": "30_trajectories.html",
    "title": "Trajectories",
    "section": "",
    "text": "This section develop trajectories per attributes.\n\n\nCode\nequ &lt;- cmdstan_model(\"models/equilibirum.stan\")\nrec_pos &lt;- cmdstan_model(\"models/recovery_positive.stan\")\nrec &lt;- cmdstan_model(\"models/recovery.stan\")\nvars &lt;- c(\n  \"ba\", \"agb\", \"nstem\", \"gini\",\n  \"diversity_q1_gen\", \"diversity_q1_sp\", \"diversity_q0_gen\", \"diversity_q0_sp\", \n  \"FDiv\",\n  \"WD_cwm_ba\", \"SLA_cwm_ba\"\n)\nvars &lt;- c(\n  \"WD_cwm_ba\"\n)\nlapply(vars, sample_equ)\nlapply(vars, sample_rec)"
  },
  {
    "objectID": "31_ba.html",
    "href": "31_ba.html",
    "title": "Str - BA",
    "section": "",
    "text": "Basal areas in square meter per square meter directly derived from diameter censuses.\n\n\nCode\nvar &lt;- \"ba\"\nlab &lt;- expression(\"BA [\" ~ m^2 ~ m^{\n  -2\n} ~ \"]\")\ndata &lt;- load_all(var, lab)\n\n\n\n\nCode\nequ_theta_fig(data)\n\n\n\n\n\nTheta posterior from forests at equilibirum.\n\n\n\n\n\n\nCode\ndata$fit_rec\n\n\n variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__     6587.35 6589.91 55.95 57.01 6492.06 6675.08 1.11       27      199\n phi_p[1]    0.53    0.56  0.15  0.12    0.22    0.71 1.00     1968     1700\n phi_p[2]    0.69    0.73  0.24  0.26    0.24    0.98 1.00     3210     2674\n phi_p[3]    0.67    0.71  0.18  0.14    0.27    0.89 1.00     1214     1618\n phi_p[4]    0.69    0.75  0.25  0.27    0.22    0.99 1.00     3109     2434\n phi_p[5]    0.71    0.78  0.24  0.25    0.22    0.99 1.00     2316     2224\n phi_p[6]    0.76    0.85  0.24  0.17    0.25    0.99 1.00     1738     1904\n phi_p[7]    0.56    0.59  0.15  0.13    0.24    0.76 1.00     1361     1706\n phi_p[8]    0.75    0.81  0.19  0.13    0.30    0.96 1.00     1974     2227\n phi_p[9]    0.74    0.79  0.19  0.13    0.31    0.95 1.00     1605     1885\n\n # showing 10 of 42493 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data)\n\n\n\n\n\nPredicted trajectories.\n\n\n\n\n\n\nCode\nrec_theta_fig(data)\n\n\n\n\n\nTheta posterior from recovery trajectories against its posterior.\n\n\n\n\n\n\nCode\ndist_obs &lt;- data$data_rec %&gt;% \n  group_by(site, plot) %&gt;%\n  summarise(ba_post = min(value, na.rm = TRUE)) %&gt;% \n  left_join(data$data_equ %&gt;%\n              filter(rel_year &lt;= 0) %&gt;%\n              group_by(site, plot) %&gt;%\n              summarise(ba_pre = median(value, na.rm = TRUE))) %&gt;% \n  na.omit() %&gt;% \n  mutate(dist_obs = (ba_pre - ba_post) / ba_pre * 100) %&gt;%\n  select(site, plot, dist_obs) %&gt;%\n  filter(dist_obs &gt; 0)\ndata$fit_rec$summary(\"phipct_p\") %&gt;% \n  separate(variable, c(\"X1\", \"X2\", \"plotnum\"), convert = TRUE) %&gt;% \n  select(-X1, -X2) %&gt;% \n  left_join(data$ind_rec) %&gt;% \n  left_join(dist_obs) %&gt;%\n  na.omit() %&gt;%\n  ggplot(aes(median, dist_obs)) +\n  geom_abline(col = \"darkgrey\") +\n  geom_segment(aes(x = median - sd, xend = median + sd)) +\n  geom_segment(aes(x = q5, xend = q95), size = .1) +\n  geom_point() +\n  facet_wrap(~site) +\n  theme_bw() +\n  ggpubr::stat_cor(size = 3) +\n  xlab(expression(phi[BA] ~ \"inferred [ % lost ]\")) +\n  ylab(expression(dist[BA] ~ \"observed [ % lost ]\")) +\n  theme(panel.spacing = unit(0, \"lines\"))"
  },
  {
    "objectID": "32_agb.html",
    "href": "32_agb.html",
    "title": "Str - AGB",
    "section": "",
    "text": "Aboveground biomass recovery in tons per hectare derived from censuses using species names to derive first wood density and the biomass with the R package BIOMASS (Réjou-Méchain et al. 2017).\n\n\nCode\nvar &lt;- \"agb\"\nlab &lt;- expression(\"AGB [ t\" ~ ha^{\n  -1\n} ~ \"]\")\ndata &lt;- load_all(var, lab)\n\n\n\n\nCode\nequ_theta_fig(data)\n\n\n\n\n\nTheta posterior from forests at equilibirum.\n\n\n\n\n\n\nCode\ndata$fit_rec\n\n\n variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__     6015.91 6016.88 51.69 52.14 5929.69 6100.82 1.01      225      439\n phi_p[1]    0.41    0.43  0.11  0.10    0.18    0.57 1.00     1054      843\n phi_p[2]    0.72    0.78  0.23  0.24    0.26    0.99 1.00     1593     1986\n phi_p[3]    0.54    0.57  0.15  0.11    0.21    0.72 1.00     1280     1107\n phi_p[4]    0.77    0.86  0.23  0.16    0.29    0.99 1.00     1534     2406\n phi_p[5]    0.79    0.87  0.21  0.13    0.31    0.99 1.00     1721     2450\n phi_p[6]    0.71    0.76  0.18  0.13    0.29    0.92 1.00     1214     1695\n phi_p[7]    0.49    0.52  0.13  0.11    0.22    0.66 1.00     1233     1037\n phi_p[8]    0.60    0.63  0.15  0.12    0.28    0.79 1.00     1312     1223\n phi_p[9]    0.76    0.82  0.19  0.13    0.32    0.97 1.00     1448     1378\n\n # showing 10 of 42493 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data)\n\n\n\n\n\nPredicted trajectories.\n\n\n\n\n\n\nCode\nrec_theta_fig(data)\n\n\n\n\n\nTheta posterior from recovery trajectories against its posterior.\n\n\n\n\n\n\n\n\nRéjou-Méchain, Maxime, Ariane Tanguy, Camille Piponiot, Jérôme Chave, and Bruno Hérault. 2017. “Biomass: An r Package for Estimating Above-Ground Biomass and Its Uncertainty in Tropical Forests.” Edited by Sarah Goslee. Methods in Ecology and Evolution 8 (9): 1163–67. https://doi.org/10.1111/2041-210x.12753."
  },
  {
    "objectID": "33_stem.html",
    "href": "33_stem.html",
    "title": "Str - Stem",
    "section": "",
    "text": "Stem density in trees per hectare directly derived from censuses.\n\n\nCode\nvar &lt;- \"nstem\"\nlab &lt;- expression(\"Stem [ trees\" ~ ha^{\n  -1\n} ~ \"]\")\ndata &lt;- load_all(var, lab)\n\n\n\n\nCode\nequ_theta_fig(data)\n\n\n\n\n\nTheta posterior from forests at equilibirum.\n\n\n\n\n\n\nCode\ndata$fit_rec\n\n\n variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__     5856.22 5856.74 46.09 47.41 5779.72 5929.23 1.02      455     1169\n phi_p[1]    0.72    0.79  0.23  0.21    0.22    0.98 1.00     1763     1837\n phi_p[2]    0.64    0.68  0.25  0.29    0.20    0.97 1.01     3527     2731\n phi_p[3]    0.67    0.73  0.22  0.20    0.21    0.94 1.00     2065     1738\n phi_p[4]    0.64    0.67  0.25  0.29    0.19    0.97 1.00     2885     2446\n phi_p[5]    0.63    0.66  0.25  0.30    0.18    0.97 1.00     2728     2404\n phi_p[6]    0.64    0.67  0.25  0.30    0.20    0.97 1.00     3244     2881\n phi_p[7]    0.70    0.77  0.25  0.25    0.21    0.98 1.00     2027     2355\n phi_p[8]    0.63    0.67  0.25  0.31    0.18    0.97 1.00     3051     2572\n phi_p[9]    0.70    0.77  0.22  0.20    0.24    0.97 1.00     2001     1952\n\n # showing 10 of 42493 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data)\n\n\n\n\n\nPredicted trajectories.\n\n\n\n\n\n\nCode\nrec_theta_fig(data)\n\n\n\n\n\nTheta posterior from recovery trajectories against its posterior."
  },
  {
    "objectID": "34_gini.html",
    "href": "34_gini.html",
    "title": "Str - Gini",
    "section": "",
    "text": "The Gini coefficient measures the inequality among the values of a the diameter distribution in censuses. A Gini coefficient of 0 reflects perfect equality, where all diameter values are the same, while a Gini coefficient of 1 (or 100%) reflects maximal inequality among diameters. See https://en.wikipedia.org/wiki/Gini_coefficient.\n\n\nCode\nvar &lt;- \"gini\"\nlab &lt;- \"Gini index\"\ndata &lt;- load_all(var, lab)\n\n\n\n\nCode\nequ_theta_fig(data)\n\n\n\n\n\nTheta posterior from forests at equilibirum.\n\n\n\n\n\n\nCode\ndata$fit_rec\n\n\n variable     mean   median    sd   mad       q5      q95 rhat ess_bulk\n lp__     11696.19 11698.05 60.12 58.93 11593.60 11792.10 1.16       18\n phi_p[1]     0.79     0.80  0.07  0.05     0.69     0.89 1.01     1000\n phi_p[2]     0.76     0.76  0.07  0.05     0.65     0.86 1.01      942\n phi_p[3]     0.81     0.82  0.06  0.05     0.72     0.90 1.00     1752\n phi_p[4]     0.81     0.82  0.07  0.05     0.71     0.90 1.01      980\n phi_p[5]     0.78     0.79  0.06  0.05     0.69     0.87 1.00     1110\n phi_p[6]     0.65     0.66  0.07  0.06     0.53     0.75 1.01      970\n phi_p[7]     0.71     0.71  0.07  0.06     0.60     0.80 1.01     1408\n phi_p[8]     0.66     0.67  0.08  0.06     0.53     0.77 1.02     1051\n phi_p[9]     0.88     0.88  0.06  0.05     0.79     0.96 1.00      971\n ess_tail\n      145\n      705\n      630\n     1317\n      704\n      734\n     1127\n     1245\n      951\n     1002\n\n # showing 10 of 42493 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data)\n\n\n\n\n\nPredicted trajectories.\n\n\n\n\n\n\nCode\nrec_theta_fig(data)\n\n\n\n\n\nTheta posterior from recovery trajectories against its posterior."
  },
  {
    "objectID": "41_gen_q1.html",
    "href": "41_gen_q1.html",
    "title": "Div - Genus",
    "section": "",
    "text": "Genus diversity is measured using Hill’s number with order \\(q=1\\). Hill’s numbers are parameterised by a diversity order \\(q\\), which determines the sensitivity of the measures to the relative abundances of species. Hill’s numbers include the three most commonly used measures of species diversity as special cases: species richness (q = 0), Shannon diversity (q = 1) and Simpson diversity (q = 2). The indices were derived from taxonomic censuses and cleaned taxonomies using the R package entropart (Marcon and Hérault 2015). Finally, to account for differences in species identification, the indices have been corrected by a rarefaction curve, taking into account the value at 80% coverage.\n\n\nCode\nvar &lt;- \"diversity_q1_gen\"\nlab &lt;- expression(\"Genus diversity\" ~ q == 1)\ndata &lt;- load_all(var, lab)\n\n\n\n\nCode\nequ_theta_fig(data)\n\n\n\n\n\nTheta posterior from forests at equilibirum.\n\n\n\n\n\n\nCode\ndata$fit_rec\n\n\n variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__     9422.00 9424.22 59.04 61.07 9323.71 9516.91 1.44        8       49\n phi_p[1]    0.58    0.59  0.13  0.12    0.33    0.77 1.04       69     1437\n phi_p[2]    0.42    0.43  0.15  0.14    0.17    0.63 1.08       32     1124\n phi_p[3]    0.71    0.72  0.12  0.09    0.49    0.87 1.02      892     1362\n phi_p[4]    0.72    0.74  0.13  0.10    0.48    0.89 1.02      218     1323\n phi_p[5]    0.51    0.53  0.14  0.13    0.24    0.71 1.07       35     1148\n phi_p[6]    0.39    0.40  0.14  0.14    0.17    0.61 1.07       38     1631\n phi_p[7]    0.37    0.38  0.13  0.14    0.15    0.56 1.07       44     1440\n phi_p[8]    0.56    0.58  0.14  0.12    0.29    0.77 1.06       49      922\n phi_p[9]    0.40    0.41  0.15  0.14    0.16    0.61 1.07       36     1027\n\n # showing 10 of 42493 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data)\n\n\n\n\n\nPredicted trajectories.\n\n\n\n\n\n\nCode\nrec_theta_fig(data)\n\n\n\n\n\nTheta posterior from recovery trajectories against its posterior.\n\n\n\n\n\n\n\n\nMarcon, Eric, and Bruno Hérault. 2015. “Entropart: AnRPackage to Measure and Partition Diversity.” Journal of Statistical Software 67 (8). https://doi.org/10.18637/jss.v067.i08."
  },
  {
    "objectID": "42_fdiv.html",
    "href": "42_fdiv.html",
    "title": "Div - FDiv",
    "section": "",
    "text": "Functional diversity is measured through functional divergence Fdiv, the “Species deviance from the mean distance to the centre of gravity weighted by relative abundance” (Mouchet et al. 2010).\n\n\nCode\nvar &lt;- \"FDiv\"\nlab &lt;- expression(\"FDiv\")\ndata &lt;- load_all(var, lab)\n\n\n\n\nCode\nequ_theta_fig(data)\n\n\n\n\n\nTheta posterior from forests at equilibirum.\n\n\n\n\n\n\nCode\ndata$fit_rec\n\n\n variable     mean   median     sd    mad       q5      q95 rhat ess_bulk\n lp__     10755.35 10648.50 301.58 158.12 10439.69 11311.60 2.50        4\n phi_p[1]     0.91     0.96   0.13   0.04     0.61     1.00 1.14      110\n phi_p[2]     0.58     0.62   0.17   0.18     0.25     0.77 1.19       14\n phi_p[3]     0.77     0.82   0.15   0.08     0.46     0.93 1.08       33\n phi_p[4]     0.62     0.65   0.17   0.17     0.27     0.81 1.20       13\n phi_p[5]     0.67     0.71   0.17   0.14     0.33     0.85 1.19       14\n phi_p[6]     0.80     0.84   0.14   0.10     0.50     0.94 1.15       18\n phi_p[7]     0.53     0.58   0.16   0.13     0.21     0.76 1.19       47\n phi_p[8]     0.87     0.91   0.12   0.06     0.65     0.98 1.20       90\n phi_p[9]     0.56     0.59   0.18   0.21     0.22     0.77 1.29       10\n ess_tail\n       32\n     1904\n      897\n      939\n      390\n      342\n     1436\n      340\n     1154\n      276\n\n # showing 10 of 42493 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data)\n\n\n\n\n\nPredicted trajectories.\n\n\n\n\n\n\nCode\nrec_theta_fig(data)\n\n\n\n\n\nTheta posterior from recovery trajectories against its posterior.\n\n\n\n\n\n\n\n\nMouchet, Maud A., Sébastien Villéger, Norman W. H. Mason, and David Mouillot. 2010. “Functional Diversity Measures: An Overview of Their Redundancy and Their Ability to Discriminate Community Assembly Rules.” Functional Ecology 24 (4): 867–76. https://doi.org/10.1111/j.1365-2435.2010.01695.x."
  },
  {
    "objectID": "43_sp_q1.html",
    "href": "43_sp_q1.html",
    "title": "Div - Species",
    "section": "",
    "text": "Code\nvar &lt;- \"diversity_q1_sp\"\nlab &lt;- expression(\"Species diversity\" ~ q == 1)\ndata &lt;- load_all(var, lab)\n\n\n\n\nCode\nequ_theta_fig(data)\n\n\n\n\n\nTheta posterior from forests at equilibirum.\n\n\n\n\n\n\nCode\ndata$fit_rec\n\n\n variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__     8930.92 8935.36 63.61 70.27 8823.56 9029.09 1.60        6       42\n phi_p[1]    0.58    0.60  0.17  0.16    0.26    0.84 1.00     2243     1881\n phi_p[2]    0.52    0.54  0.16  0.15    0.23    0.78 1.00     1694     1432\n phi_p[3]    0.59    0.61  0.17  0.16    0.28    0.85 1.00     1885     1233\n phi_p[4]    0.77    0.80  0.15  0.13    0.48    0.96 1.00     2389     1463\n phi_p[5]    0.69    0.70  0.15  0.14    0.40    0.90 1.00     3118     1882\n phi_p[6]    0.31    0.28  0.15  0.14    0.12    0.57 1.01     3056     1972\n phi_p[7]    0.30    0.28  0.15  0.14    0.12    0.58 1.00     2536     1874\n phi_p[8]    0.49    0.50  0.16  0.16    0.20    0.75 1.00     2174     1623\n phi_p[9]    0.52    0.52  0.17  0.16    0.22    0.78 1.00     1651     1296\n\n # showing 10 of 42493 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data)\n\n\n\n\n\nPredicted trajectories.\n\n\n\n\n\n\nCode\nrec_theta_fig(data)\n\n\n\n\n\nTheta posterior from recovery trajectories against its posterior."
  },
  {
    "objectID": "44_gen_q0.html",
    "href": "44_gen_q0.html",
    "title": "Div - Genus 0",
    "section": "",
    "text": "Code\nvar &lt;- \"diversity_q0_gen\"\nlab &lt;- expression(\"Genus diversity\" ~ q == 0)\ndata &lt;- load_all(var, lab)\n\n\n\n\nCode\nequ_theta_fig(data)\n\n\n\n\n\nTheta posterior from forests at equilibirum.\n\n\n\n\n\n\nCode\ndata$fit_rec\n\n\n variable     mean   median     sd    mad       q5      q95 rhat ess_bulk\n lp__     10300.71 10332.05 136.36 108.82 10056.39 10483.31 2.30        5\n phi_p[1]     0.42     0.43   0.15   0.14     0.16     0.64 1.07       49\n phi_p[2]     0.39     0.39   0.14   0.14     0.15     0.60 1.04       68\n phi_p[3]     0.48     0.50   0.15   0.13     0.19     0.70 1.07       39\n phi_p[4]     0.61     0.63   0.15   0.11     0.31     0.81 1.05       71\n phi_p[5]     0.50     0.53   0.16   0.14     0.20     0.73 1.07       45\n phi_p[6]     0.49     0.51   0.16   0.13     0.19     0.71 1.06       42\n phi_p[7]     0.35     0.35   0.14   0.14     0.13     0.59 1.03      117\n phi_p[8]     0.47     0.50   0.15   0.13     0.18     0.68 1.09       38\n phi_p[9]     0.38     0.38   0.15   0.14     0.14     0.60 1.04       97\n ess_tail\n       30\n     1628\n      310\n      374\n      341\n      902\n      308\n     1667\n      225\n     1408\n\n # showing 10 of 42493 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data)\n\n\n\n\n\nPredicted trajectories.\n\n\n\n\n\n\nCode\nrec_theta_fig(data)\n\n\n\n\n\nTheta posterior from recovery trajectories against its posterior."
  },
  {
    "objectID": "45_sp_q0.html",
    "href": "45_sp_q0.html",
    "title": "Div - Species 0",
    "section": "",
    "text": "Code\nvar &lt;- \"diversity_q0_sp\"\nlab &lt;- expression(\"Species diversity\" ~ q == 0)\ndata &lt;- load_all(var, lab)\n\n\n\n\nCode\nequ_theta_fig(data)\n\n\n\n\n\nTheta posterior from forests at equilibirum.\n\n\n\n\n\n\nCode\ndata$fit_rec\n\n\n variable    mean  median    sd   mad      q5     q95 rhat ess_bulk ess_tail\n lp__     9756.38 9758.03 44.96 45.97 9679.62 9827.13 1.05       95     1040\n phi_p[1]    0.41    0.41  0.17  0.18    0.15    0.72 1.01     2229     1923\n phi_p[2]    0.46    0.47  0.18  0.18    0.17    0.75 1.02     1284     1808\n phi_p[3]    0.38    0.37  0.16  0.17    0.14    0.66 1.01     3501     1959\n phi_p[4]    0.62    0.65  0.18  0.16    0.28    0.88 1.02     2562     1779\n phi_p[5]    0.52    0.54  0.18  0.17    0.19    0.81 1.03     1739     1314\n phi_p[6]    0.37    0.35  0.17  0.17    0.14    0.67 1.01     3082     2062\n phi_p[7]    0.33    0.31  0.16  0.15    0.13    0.63 1.00     3058     1954\n phi_p[8]    0.44    0.45  0.18  0.18    0.15    0.75 1.02     2180     1175\n phi_p[9]    0.36    0.35  0.16  0.16    0.14    0.66 1.01     3234     1351\n\n # showing 10 of 42493 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data)\n\n\n\n\n\nPredicted trajectories.\n\n\n\n\n\n\nCode\nrec_theta_fig(data)\n\n\n\n\n\nTheta posterior from recovery trajectories against its posterior."
  },
  {
    "objectID": "51_wd.html",
    "href": "51_wd.html",
    "title": "Func - WD",
    "section": "",
    "text": "Code\ndata$fit_rec$draws(\"tau0_s[21]\") %&gt;% \n  mcmc_trace() +\n  scale_y_sqrt()\n\ndata$fit_rec$draws(\"tau0_s\") %&gt;% \n  mcmc_trace() +\n  scale_y_sqrt()\n\n\n\n\nCode\ndata$fit_rec$summary(\"delta_s\") %&gt;% \n  separate(variable, c(\"delta\", \"s\", \"sitenum\"), convert = TRUE) %&gt;% \n  left_join(data$ind_rec) %&gt;% \n  filter(site == 'Paracou') %&gt;% \n  ggplot(aes(median)) + \n  geom_histogram() + \n  theme_bw() +\n  facet_wrap(~ site, scales = \"free_y\") +\n  theme(axis.text.x = element_text(angle = 90)) +\n  scale_x_sqrt()\n\n\n\n\nCode\ndata$fit_rec$summary(\"lambda_p\") %&gt;% \n  separate(variable, c(\"delta\", \"p\", \"plotnum\"), convert = TRUE) %&gt;% \n  left_join(data$ind_rec) %&gt;% \n  ggplot(aes(median)) + \n  geom_histogram() + \n  theme_bw() +\n  facet_wrap(~ site, scales = \"free_y\") +\n  theme(axis.text.x = element_text(angle = 90))\n\n\nWood Density trajectories have been quantified using the community weighted mean, the average of the local distribution of a trait in a community. The trait value is weighted by tree basal area to better represent their biomass contribution in the community.\n\n\nCode\nvar &lt;- \"WD_cwm_ba\"\nlab &lt;- expression(\"WD [ g\" ~ cm^{\n  -3\n} ~ \"]\")\ndata &lt;- load_all(var, lab)\n\n\n\n\nCode\nequ_theta_fig(data)\n\n\n\n\n\nTheta posterior from forests at equilibirum.\n\n\n\n\n\n\nCode\ndata$fit_rec\n\n\n variable     mean   median     sd    mad       q5      q95 rhat ess_bulk\n lp__     13017.21 13006.10 133.69 129.73 12826.99 13264.14 1.28       11\n phi_p[1]     0.85     0.85   0.04   0.03     0.79     0.90 1.01     1133\n phi_p[2]     0.96     0.98   0.08   0.02     0.82     1.00 1.00     1479\n phi_p[3]     0.87     0.88   0.06   0.03     0.80     0.93 1.02      712\n phi_p[4]     0.95     0.95   0.04   0.03     0.89     0.99 1.00     1211\n phi_p[5]     0.94     0.98   0.12   0.02     0.71     1.00 1.00     1225\n phi_p[6]     0.93     0.94   0.06   0.03     0.86     0.98 1.01      295\n phi_p[7]     0.95     0.98   0.09   0.02     0.79     1.00 1.00     1209\n phi_p[8]     0.95     0.95   0.04   0.03     0.89     0.99 1.01     1001\n phi_p[9]     0.96     0.98   0.06   0.02     0.88     1.00 1.01     1080\n ess_tail\n       49\n      516\n      833\n      269\n      893\n      815\n       78\n      746\n      922\n      604\n\n # showing 10 of 42493 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data)\n\n\n\n\n\nPredicted trajectories.\n\n\n\n\n\n\nCode\nrec_theta_fig(data)\n\n\n\n\n\nTheta posterior from recovery trajectories against its posterior."
  },
  {
    "objectID": "52_sla.html",
    "href": "52_sla.html",
    "title": "Func - SLA",
    "section": "",
    "text": "Specific Leaf Area trajectories have been quantified using the community weighted mean, the average of the local distribution of a trait in a community. The trait value is weighted by tree basal area to better represent their biomass contribution in the community.\n\n\nCode\nvar &lt;- \"SLA_cwm_ba\"\nlab &lt;- expression(\"SLA [\" ~ mm^2 ~ mg^{\n  -1\n} ~ \"]\")\ndata &lt;- load_all(var, lab)\n\n\n\n\nCode\nequ_theta_fig(data)\n\n\n\n\n\nTheta posterior from forests at equilibirum.\n\n\n\n\n\n\nCode\ndata$fit_rec\n\n\n variable     mean   median     sd   mad       q5      q95 rhat ess_bulk\n lp__     14172.58 14136.55 110.09 82.80 14039.19 14378.01 1.76        6\n phi_p[1]     0.89     0.90   0.06  0.04     0.79     0.96 1.01     2188\n phi_p[2]     0.58     0.60   0.12  0.10     0.36     0.72 1.05       68\n phi_p[3]     0.90     0.90   0.06  0.04     0.80     0.97 1.00     1953\n phi_p[4]     0.58     0.60   0.11  0.10     0.37     0.72 1.04       77\n phi_p[5]     0.69     0.70   0.09  0.08     0.53     0.80 1.03       96\n phi_p[6]     0.67     0.69   0.09  0.08     0.50     0.79 1.04       80\n phi_p[7]     0.49     0.50   0.13  0.12     0.25     0.65 1.05       53\n phi_p[8]     0.58     0.60   0.11  0.10     0.37     0.72 1.04       75\n phi_p[9]     0.58     0.60   0.11  0.09     0.38     0.72 1.04       65\n ess_tail\n       40\n     1571\n     1661\n     1497\n     1878\n     2111\n     1670\n     1121\n     1023\n     1294\n\n # showing 10 of 42493 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\n\n\nCode\npvo_fig(data)\n\n\n\n\n\nPredicted versus observed.\n\n\n\n\n\n\nCode\nproj_fig(data)\n\n\n\n\n\nPredicted trajectories.\n\n\n\n\n\n\nCode\nrec_theta_fig(data)\n\n\n\n\n\nTheta posterior from recovery trajectories against its posterior."
  },
  {
    "objectID": "60_parameters.html#likelihood-convergence",
    "href": "60_parameters.html#likelihood-convergence",
    "title": "Parameters",
    "section": "Likelihood convergence",
    "text": "Likelihood convergence\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"lp__\") %&gt;%\n  ggplot(aes(forcats::fct_reorder(attribute, desc(rhat)),\n    rhat,\n    fill = rhat\n  )) +\n  geom_col() +\n  coord_flip() +\n  theme_bw() +\n  scale_fill_viridis_c(expression(hat(R)), trans = \"log\") +\n  theme(axis.title = element_blank()) +\n  geom_hline(yintercept = c(1, 1.1), linetype = \"dashed\")\n\n\n\n\n\nLikelihood convergence per forest attribute."
  },
  {
    "objectID": "60_parameters.html#inter-site",
    "href": "60_parameters.html#inter-site",
    "title": "Parameters",
    "section": "Inter-site",
    "text": "Inter-site\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(\n    level == \"inter\",\n    parameter != \"lp__\",\n  ) %&gt;%\n  filter(!(parameter %in% c(\n    \"mu_deltapct\", \"mu_phipct\",\n    \"mu_t90\", \"mu_tau0\"\n  ))) %&gt;%\n  ggplot(aes(x = attr_long, col = type)) +\n  geom_point(aes(y = median)) +\n  geom_segment(aes(y = median - sd, yend = median + sd)) +\n  geom_segment(aes(y = q5, yend = q95), size = .1) +\n  facet_wrap(~par_parsed, scales = \"free\", labeller = label_parsed) +\n  coord_flip() +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(\"\") +\n  ylim(0, NA)\n\n\n\n\n\nGlobal parameters across sites."
  },
  {
    "objectID": "60_parameters.html#site",
    "href": "60_parameters.html#site",
    "title": "Parameters",
    "section": "Site",
    "text": "Site\n\nAsymptotic value \\(\\theta\\)\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"theta\") %&gt;%\n  unique() %&gt;%\n  ggplot(aes(site, color = region)) +\n  geom_point(aes(y = median)) +\n  geom_segment(aes(y = median - sd, yend = median + sd)) +\n  geom_segment(aes(y = q5, yend = q95), size = .1) +\n  facet_wrap(~attr_long, scales = \"free_x\") +\n  theme_bw() +\n  coord_flip() +\n  ylab(expression(theta)) +\n  xlab(\"\")\n\n\n\n\n\ntheta across sites.\n\n\n\n\n\n\nBump time \\(\\tau\\)\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"tau\") %&gt;%\n  unique() %&gt;%\n  mutate_at(c(\"median\", \"sd\", \"q5\", \"q95\"), ~ . + 3) %&gt;%\n  ggplot(aes(site, color = region)) +\n  geom_point(aes(y = median)) +\n  geom_segment(aes(y = median - sd, yend = median + sd)) +\n  geom_segment(aes(y = q5, yend = q95), size = .1) +\n  facet_wrap(~attr_long) +\n  theme_bw() +\n  coord_flip() +\n  ylab(expression(tau)) +\n  xlab(\"\")\n\n\n\n\n\ntau across sites"
  },
  {
    "objectID": "60_parameters.html#plot",
    "href": "60_parameters.html#plot",
    "title": "Parameters",
    "section": "Plot",
    "text": "Plot\n\nDisturbance index \\(\\phi\\)\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"phipct\", attribute == \"ba\") %&gt;%\n  unique() %&gt;%\n  ggplot(aes(plot)) +\n  geom_point(aes(y = median)) +\n  geom_segment(aes(y = median - sd, yend = median + sd)) +\n  geom_segment(aes(y = q5, yend = q95), size = .1) +\n  facet_wrap(~site, scales = \"free_y\") +\n  theme_bw() +\n  coord_flip() +\n  ylab(expression(phi[BA] ~ \"[ % lost ]\")) +\n  xlab(\"Plot\") +\n  theme(\n    axis.text.y = element_blank(),\n    axis.ticks.y = element_blank(),\n    panel.spacing = unit(0, \"lines\")\n  )\n\n\n\n\n\nphi across sites & plots for basal area.\n\n\n\n\n\n\nRecovery rate \\(\\lambda\\)\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"lambda\", attribute == \"ba\") %&gt;%\n  ggplot(aes(plot)) +\n  geom_point(aes(y = median)) +\n  geom_segment(aes(y = median - sd, yend = median + sd)) +\n  geom_segment(aes(y = q5, yend = q95), size = .1) +\n  facet_wrap(~site, scales = \"free\") +\n  theme_bw() +\n  coord_flip() +\n  ylab(expression(lambda[BA])) +\n  xlab(\"Plot\") +\n  scale_y_log10() +\n  theme(\n    axis.text.y = element_blank(),\n    axis.ticks.y = element_blank(),\n    panel.spacing = unit(0, \"lines\")\n  )\n\n\n\n\n\nlambda across sites & plots for basal area.\n\n\n\n\n\n\nRecovery time \\(t_{90}\\)\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"t90\", attribute == \"ba\") %&gt;%\n  unique() %&gt;%\n  ggplot(aes(plot)) +\n  geom_point(aes(y = median)) +\n  geom_segment(aes(y = median - sd, yend = median + sd)) +\n  geom_segment(aes(y = q5, yend = q95), size = .1) +\n  facet_wrap(~site, scales = \"free\") +\n  theme_bw() +\n  coord_flip() +\n  ylab(expression(t[90][BA] ~ \"[ yr ]\")) +\n  xlab(\"Plot\") +\n  scale_y_log10() +\n  theme(\n    axis.text.y = element_blank(),\n    axis.ticks.y = element_blank(),\n    panel.spacing = unit(0, \"lines\")\n  )\n\n\n\n\n\nt90 across sites & plots for basal area.\n\n\n\n\n\n\nBump intensity \\(\\delta\\)\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"deltapct\", attribute == \"diversity_q1_gen\") %&gt;%\n  unique() %&gt;%\n  ggplot(aes(plot)) +\n  geom_point(aes(y = median)) +\n  geom_segment(aes(y = median - sd, yend = median + sd)) +\n  geom_segment(aes(y = q5, yend = q95), size = .1) +\n  facet_wrap(~site, scales = \"free_y\") +\n  theme_bw() +\n  coord_flip() +\n  ylab(expression(delta[Genus] ~ \"[ % ]\")) +\n  xlab(\"Plot\") +\n  theme(\n    axis.text.y = element_blank(),\n    axis.ticks.y = element_blank(),\n    panel.spacing = unit(0, \"lines\")\n  )\n\n\n\n\n\ndelta across sites & plots for genus diversity.\n\n\n\n\n\n\n15-year bump \\(y_{15}\\)\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"y15\", attribute == \"diversity_q1_gen\") %&gt;%\n  unique() %&gt;%\n  ggplot(aes(plot)) +\n  geom_point(aes(y = median * 100)) +\n  geom_segment(aes(y = (median - sd) * 100, yend = (median + sd) * 100)) +\n  geom_segment(aes(y = q5, yend = q95), size = .1) +\n  facet_wrap(~site, scales = \"free_y\") +\n  theme_bw() +\n  coord_flip() +\n  ylab(expression(y[15][Genus] ~ \"[ % ]\")) +\n  xlab(\"Plot\") +\n  theme(\n    axis.text.y = element_blank(),\n    axis.ticks.y = element_blank(),\n    panel.spacing = unit(0, \"lines\")\n  )\n\n\n\n\n\n15-year bump across sites & plots for genus diversity."
  },
  {
    "objectID": "61_group1.html#h1---diversity-time",
    "href": "61_group1.html#h1---diversity-time",
    "title": "Group 1",
    "section": "H1 - Diversity & time",
    "text": "H1 - Diversity & time\n\nH1: tree diversity long-term response increases through time to a maximum value, after which it then declines in late succession\n\nKibale and Mbaiki have been removed has they don’t have short term data. But, do we trust Malinau’s bump with solely three recent inventories? Genus diversity are good and could be trusted even if a few outlier sites delta might be underestimated, but is not a data issue? However, functional diversity trajectory is still not good enough needing either model or data tweaking. Genus diversity delta distribution are bimodal and should be explored, e.g. I don’t trust low delta in Paracou that are the sites lacking genus identification. Also how much plot delta max per site is linked to tau site being itself linked to the duration of inventories?\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(level == \"site\") %&gt;%\n  filter(!(site %in% c(\"Kibale\", \"Uppangala\"))) %&gt;%\n  filter(type == \"diversity\" & parameter == \"tau\") %&gt;%\n  ggplot(aes(x = site, col = region)) +\n  geom_point(aes(y = median)) +\n  geom_segment(aes(y = median - sd, yend = median + sd)) +\n  geom_segment(aes(y = q5, yend = q95), size = .1) +\n  facet_wrap(~attr_long) +\n  coord_flip() +\n  theme_bw() +\n  ylab(expression(tau ~ \"[ year ]\")) +\n  xlab(\"\") +\n  scale_color_discrete(\"\") +\n  ggtitle(expression(Site ~ tau)) +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(level == \"plot\") %&gt;%\n  filter(!(site %in% c(\"Kibale\", \"Uppangala\"))) %&gt;%\n  filter(type == \"diversity\" & parameter == \"deltapct\") %&gt;%\n  ggplot(aes(x = median, y = site, fill = region)) +\n  ggridges::geom_density_ridges() +\n  facet_wrap(~attr_long) +\n  theme_bw() +\n  xlab(expression(delta ~ \"[ % ]\")) +\n  ylab(\"\") +\n  scale_fill_discrete(\"\") +\n  ggtitle(expression(Plot ~ delta)) +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(\n    type == \"diversity\", attribute == \"diversity_q1_gen\",\n    parameter %in% c(\"deltapct\", \"tau\")\n  ) %&gt;%\n  filter(!(site %in% c(\"Kibale\", \"Uppangala\"))) %&gt;%\n  select(attr_long, parameter, site, median) %&gt;%\n  pivot_wider(names_from = parameter, values_from = median) %&gt;%\n  unnest(deltapct) %&gt;%\n  unnest(tau) %&gt;%\n  ggplot(aes(tau, deltapct, col = site)) +\n  geom_point() +\n  theme_bw() +\n  ylab(expression(delta ~ \"[ % ]\")) +\n  xlab(expression(tau ~ \"[ year ]\")) +\n  scale_color_discrete(\"\") +\n  ggtitle(expression(Plot ~ delta ~ \"~\" ~ Site ~ tau)) +\n  facet_wrap(~attr_long, scales = \"free\") +\n  ggpubr::stat_cor(aes(group = NA))"
  },
  {
    "objectID": "61_group1.html#observed-inferred-disturbance",
    "href": "61_group1.html#observed-inferred-disturbance",
    "title": "Group 1",
    "section": "Observed & inferred disturbance",
    "text": "Observed & inferred disturbance\n\n\nCode\ndata_rec &lt;- read_tsv(\"data/derived_data/data_rec.tsv\", col_types = cols()) %&gt;%\n  filter(variable == \"ba\") %&gt;%\n  filter(variable == \"ba\") %&gt;%\n  group_by(site, plot) %&gt;%\n  summarise(ba_post = min(value, na.rm = TRUE))\ndata_equ &lt;- read_tsv(\"data/derived_data/data_equ.tsv\", col_types = cols()) %&gt;%\n  filter(variable == \"ba\", rel_year &lt;= 0) %&gt;%\n  group_by(site, plot) %&gt;%\n  summarise(ba_pre = median(value, na.rm = TRUE))\ndist_obs &lt;- data_equ %&gt;%\n  left_join(data_rec) %&gt;%\n  na.omit() %&gt;%\n  mutate(dist_obs = (ba_pre - ba_post) / ba_pre * 100) %&gt;%\n  select(site, plot, dist_obs) %&gt;%\n  filter(dist_obs &gt; 0)\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"phipct\", attribute == \"ba\") %&gt;%\n  select(site, plot, median, sd, q5, q95) %&gt;%\n  unique() %&gt;%\n  left_join(dist_obs) %&gt;%\n  na.omit() %&gt;%\n  ggplot(aes(median, dist_obs)) +\n  geom_abline(col = \"darkgrey\") +\n  geom_segment(aes(x = median - sd, xend = median + sd)) +\n  geom_segment(aes(x = q5, xend = q95), size = .1) +\n  geom_point() +\n  facet_wrap(~site) +\n  theme_bw() +\n  ggpubr::stat_cor(size = 3) +\n  xlab(expression(phi[BA] ~ \"inferred [ % lost ]\")) +\n  ylab(expression(dist[BA] ~ \"observed [ % lost ]\")) +\n  theme(panel.spacing = unit(0, \"lines\"))"
  },
  {
    "objectID": "61_group1.html#h2---diversity-intensity",
    "href": "61_group1.html#h2---diversity-intensity",
    "title": "Group 1",
    "section": "H2 - Diversity & intensity",
    "text": "H2 - Diversity & intensity\n\nH2: tree diversity also shows a non-linear response to increased intensity of logging: lightly logged forests show a transient increase in tree diversity, but more intensively logged forests show a strong negative effect on diversity\n\n\n\nCode\ndist_p &lt;- read_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"phipct\", attribute == \"ba\") %&gt;%\n  select(site, plot, median, sd, q5, q95) %&gt;%\n  unique() %&gt;%\n  rename_at(c(\"median\", \"sd\", \"q5\", \"q95\"), ~ paste0(., \"_dist_ba\"))\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(!(site %in% c(\"Kibale\", \"Uppangala\"))) %&gt;%\n  filter(parameter == \"deltapct\", type == \"diversity\") %&gt;%\n  left_join(dist_p) %&gt;%\n  ggplot(aes(median_dist_ba, median, col = site)) +\n  geom_smooth(method = \"lm\", se = FALSE, col = \"black\", aes(group = NA)) +\n  geom_point() +\n  facet_wrap(~attr_long, scales = \"free\") +\n  theme_bw() +\n  xlab(expression(phi[BA] ~ \"[ % lost ]\")) +\n  ylab(expression(delta ~ \"[ % ]\")) +\n  scale_color_discrete(guide = \"none\") +\n  ggpubr::stat_cor(aes(group = NA),\n    label.x.npc = \"left\", label.y.npc = \"top\"\n  )\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(!(site %in% c(\"Kibale\", \"Uppangala\"))) %&gt;%\n  filter(parameter == \"deltapct\", type == \"diversity\") %&gt;%\n  filter(attribute == \"diversity_q1_gen\") %&gt;%\n  left_join(dist_p) %&gt;%\n  ggplot(aes(median_dist_ba, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(col = \"grey\") +\n  facet_wrap(~site) +\n  ggpubr::stat_cor(size = 3) +\n  theme_bw() +\n  xlab(expression(phi[BA] ~ \"[ % lost ]\")) +\n  ylab(expression(delta ~ \"[ % ]\")) +\n  theme(legend.position = \"bottom\") +\n  theme(panel.spacing = unit(0, \"lines\"))"
  },
  {
    "objectID": "62_group2.html#q1---recovery-rates",
    "href": "62_group2.html#q1---recovery-rates",
    "title": "Group 2",
    "section": "Q1 - Recovery rates",
    "text": "Q1 - Recovery rates\n\nQ1. How do forest attributes vary in recovery rates in the long-term?\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(\n    level == \"inter\",\n    parameter != \"lp__\", parameter == \"mu_lambda\"\n  ) %&gt;%\n  ggplot(aes(x = attr_long, col = type)) +\n  geom_point(aes(y = median)) +\n  geom_segment(aes(y = median - sd, yend = median + sd)) +\n  geom_segment(aes(y = q5, yend = q95), size = .1) +\n  coord_flip() +\n  theme_bw() +\n  ylab(expression(mu[~lambda])) +\n  xlab(\"\") +\n  ylim(0, NA)\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(\n    level == \"inter\",\n    parameter != \"lp__\", parameter == \"mu_t90\"\n  ) %&gt;%\n  ggplot(aes(x = attr_long, col = type)) +\n  geom_point(aes(y = median)) +\n  geom_segment(aes(y = median - sd, yend = median + sd)) +\n  geom_segment(aes(y = q5, yend = q95), size = .1) +\n  coord_flip() +\n  theme_bw() +\n  ylab(expression(mu[~t90] ~ \"[\" ~ years ~ \"]\")) +\n  xlab(\"\") +\n  scale_y_log10()"
  },
  {
    "objectID": "62_group2.html#q2---recovery-time-intensity",
    "href": "62_group2.html#q2---recovery-time-intensity",
    "title": "Group 2",
    "section": "Q2 - Recovery time & intensity",
    "text": "Q2 - Recovery time & intensity\n\nQ2. How does recovery time vary with disturbance intensities?\n\n\n\nCode\ndist_p &lt;- read_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"phipct\", attribute == \"ba\") %&gt;%\n  select(site, plot, median, sd, q5, q95) %&gt;%\n  unique() %&gt;%\n  rename_at(c(\"median\", \"sd\", \"q5\", \"q95\"), ~ paste0(., \"_dist_ba\"))\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"lambda\") %&gt;%\n  left_join(dist_p) %&gt;%\n  ggplot(aes(median_dist_ba, median, col = site)) +\n  geom_smooth(method = \"lm\", se = FALSE, col = \"black\", aes(group = NA)) +\n  geom_point() +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  xlab(expression(phi[BA] ~ \"[ % lost ]\")) +\n  ylab(expression(lambda)) +\n  scale_color_discrete(guide = \"none\") +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"t90\") %&gt;%\n  left_join(dist_p) %&gt;%\n  ggplot(aes(median_dist_ba, median, col = site)) +\n  geom_smooth(method = \"lm\", se = FALSE, col = \"black\", aes(group = NA)) +\n  geom_point() +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  xlab(expression(phi[BA] ~ \"[ % lost ]\")) +\n  ylab(expression(t[90] ~ \"[\" ~ years ~ \"]\")) +\n  scale_color_discrete(guide = \"none\") +\n  theme(legend.position = \"bottom\")"
  },
  {
    "objectID": "62_group2.html#q3---recovery-rates-abiotic-and-biotic-factors",
    "href": "62_group2.html#q3---recovery-rates-abiotic-and-biotic-factors",
    "title": "Group 2",
    "section": "Q3 - Recovery rates & abiotic and biotic factors",
    "text": "Q3 - Recovery rates & abiotic and biotic factors\n\nQ3. How do abiotic and biotic factors modify recovery rates?\n\nabiotic factors = soil fertility + climate stress\nbiotic factors = biodiversity + Ecological strategy (acquisitive versus conservative) + structural diversity\n\nAbiotic\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"t90\") %&gt;%\n  ggplot(aes(cwd, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(t[90] ~ \"[\" ~ years ~ \"]\")) +\n  scale_x_log10() +\n  scale_color_discrete(guide = \"none\") +\n  theme(legend.position = \"bottom\") +\n  xlab(expression(Climate ~ Water ~ Deficit ~ \"[\" ~ mm ~ year^{\n    -1\n  } ~ \"]\"))\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"t90\") %&gt;%\n  ggplot(aes(tmax, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(t[90] ~ \"[\" ~ years ~ \"]\")) +\n  scale_color_discrete(guide = \"none\") +\n  theme(legend.position = \"bottom\") +\n  xlab(expression(Maximum ~ Temperature ~ \"[\" ~ \"°\" ~ \"]\"))\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"t90\") %&gt;%\n  ggplot(aes(bdod, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(t[90] ~ \"[\" ~ years ~ \"]\")) +\n  scale_color_discrete(guide = \"none\") +\n  theme(legend.position = \"bottom\") +\n  xlab(expression(Bulk ~ Density ~ \"[\" ~ kg ~ dm^{\n    -3\n  } ~ \"]\"))\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"t90\") %&gt;%\n  ggplot(aes(soc, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(t[90] ~ \"[\" ~ years ~ \"]\")) +\n  scale_color_discrete(guide = \"none\") +\n  theme(legend.position = \"bottom\") +\n  xlab(expression(Soil ~ organic ~ Carbon ~ \"[\" ~ g ~ kg^{\n    -1\n  } ~ \"]\"))\n\n\n\n\n\n\n\nBiotic\nAll site variables are the mean values for site \\(s\\) across controls and pre-logging inventories.\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"t90\") %&gt;%\n  ggplot(aes(gini_s, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(t[90] ~ \"[\" ~ years ~ \"]\")) +\n  xlab(expression(Gini[s])) +\n  scale_color_discrete(guide = \"none\") +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"t90\") %&gt;%\n  ggplot(aes(SLA_cwm_ba_s, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(t[90] ~ \"[\" ~ years ~ \"]\")) +\n  xlab(expression(SLA ~ \"[\" ~ mm^2 ~ mg^{\n    -1\n  } ~ \"]\")) +\n  scale_color_discrete(guide = \"none\") +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"t90\") %&gt;%\n  ggplot(aes(WD_cwm_ba_s, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(t[90] ~ \"[\" ~ years ~ \"]\")) +\n  xlab(expression(WD ~ \"[\" ~ g ~ cm^{\n    -3\n  } ~ \"]\")) +\n  scale_color_discrete(guide = \"none\") +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/parameters.tsv\") %&gt;%\n  filter(parameter == \"t90\") %&gt;%\n  ggplot(aes(diversity_q1_gen_s, median)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_point(aes(col = site)) +\n  facet_wrap(~attribute, scales = \"free_y\") +\n  scale_y_log10() +\n  theme_bw() +\n  ylab(expression(t[90] ~ \"[\" ~ years ~ \"]\")) +\n  xlab(expression(\"Genus diversity\" ~ q == 1)) +\n  scale_color_discrete(guide = \"none\") +\n  theme(legend.position = \"bottom\")"
  },
  {
    "objectID": "91_stp_negative.html",
    "href": "91_stp_negative.html",
    "title": "STP negatives",
    "section": "",
    "text": "Using long term and short term processes model based on initial value \\(\\theta_0\\) we had issue with negatives values of \\(\\mu_{rec}\\) resulting in impossible log-values:\n\\[\n\\begin{align}\n\\mu_{rec} = \\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times (LTP+STP) \\\\\nLTP = 1 - e^{-\\lambda_p \\times time} \\\\\nSTP = \\delta_p \\times (\\frac{time}{\\tau_s} \\times e^{1-\\frac{time}{\\tau_s}})^2\n\\end{align}\n\\]\nNegatives values happen when the trajectory is negative and the difference of \\(\\theta\\) and the bump fall below 0, so when \\(time=\\tau\\):\n\\[\n\\begin{align}\n\\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times (1 - e^{-\\lambda_p \\times \\tau_s}+\\delta_p) \\leq 0\\\\\n\\end{align}\n\\]\nEn \\(\\lambda_p=0.5\\) et \\(\\tau_s=30\\) , \\(LTP = 1-e^{-0.5*30} \\approx 1\\), thus:\n\\[\n\\begin{align}\n\\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times (1+\\delta_p) \\leq 0\\\\\n\\theta_{\\infty,s} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times \\delta_p \\leq 0\\\\\n\\delta_p \\geq \\frac{-\\theta_{\\infty,s}}  {\\theta_{\\infty,s} - \\theta_{0,p}} ~|~ \\theta_{\\infty,s} - \\theta_{0,p} &lt; 0 \\\\\n\\delta_p \\geq \\frac{-1}  {1 - dist_p} ~|~\\theta_{0,p}=dist_p\\times\\theta_{\\infty,s} \\\\\n\\delta_p \\geq \\frac{1}  {dist_p-1}\n\\end{align}\n\\]\nWe could thus use this inequality to constrain \\(\\delta_p\\) on \\(dist_p\\) knowing that stan now accepts parameters bounds to depend on another parameter. However, this is complicated as it depends on the sign in the division above, \\(dist=1\\) is no possible, and near 1 values results in positive or negative infinite values. Thus we simply bounded \\(dist_p\\) to 1.5 for now (50% gain of attribute post-disturbance).\n\n\nCode\nmodel &lt;- function(time, dist, thetainf, lambda, tau, delta) {\n  theta0 &lt;- thetainf * dist\n  ltp &lt;- 1 - exp(-lambda * time)\n  stp &lt;- delta * (time / tau * exp(1 - time / tau))^2\n  theta0 + (thetainf - theta0) * (ltp + stp)\n}\ndata.frame(time = 1:50) %&gt;%\n  mutate(y = model(time,\n    dist = 2, thetainf = 20,\n    lambda = 0.5, tau = 30, delta = 0.5\n  )) %&gt;%\n  mutate(y2 = model(time,\n    dist = 2, thetainf = 20,\n    lambda = 0.5, tau = 30, delta = 2\n  )) %&gt;%\n  mutate(y3 = model(time,\n    dist = 2, thetainf = 20,\n    lambda = 0.5, tau = 30, delta = 1\n  )) %&gt;%\n  ggplot(aes(time)) +\n  geom_line(aes(y = y, col = \"dist=2, delta=.5\")) +\n  geom_line(aes(y = y2, col = \"dist=2, delta=2\")) +\n  geom_line(aes(y = y3, col = \"dist=2, delta=1\")) +\n  theme_bw()\n\n\n\n\n\nNegative STR examples with delta-dist link.\n\n\n\n\n\n\nCode\ndata.frame(dist = seq(.5, 2, length.out = 100)) %&gt;%\n  mutate(delta_max = 2 - (1 / (dist - 1))) %&gt;%\n  ggplot(aes(dist, delta_max)) +\n  geom_line() +\n  theme_bw()\n\n\n\n\n\ndelta_max with dist."
  },
  {
    "objectID": "92_model_devs.html#stp-sum",
    "href": "92_model_devs.html#stp-sum",
    "title": "Models devs",
    "section": "STP sum",
    "text": "STP sum\nmodels/stp_sum.stan\n\\[\n\\begin{align}\n\\mu_{rec} = \\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times (LTP+STP) \\\\\nLTP = 1 - e^{-\\lambda_p \\times time} \\\\\nSTP = \\delta_p \\times (\\frac{time}{\\tau_s} \\times e^{1-\\frac{time}{\\tau_s}})^2 \\\\\n\\theta_{0,p} = \\theta_{\\infty,s} \\times dist_p\n\\end{align}\n\\]"
  },
  {
    "objectID": "92_model_devs.html#stp-lognormal",
    "href": "92_model_devs.html#stp-lognormal",
    "title": "Models devs",
    "section": "STP lognormal",
    "text": "STP lognormal\nmodels/stp.stan\n\\[\n\\begin{align}\n\\mu_{rec} = \\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times (LTP+STP) \\\\\nLTP = 1 - e^{-\\lambda_p \\times time} \\\\\nSTP = \\delta_p \\times (\\frac{time}{\\tau_s} \\times e^{1-\\frac{time}{\\tau_s}})^2 \\\\\n\\theta_{0,p} = \\theta_{\\infty,s} \\times dist_p\n\\end{align}\n\\]"
  },
  {
    "objectID": "92_model_devs.html#stp-correlated",
    "href": "92_model_devs.html#stp-correlated",
    "title": "Models devs",
    "section": "STP correlated",
    "text": "STP correlated\nmodels/stp_cor.stan\nImposed variance-covariance matrix on dist_p and delta_p.\n\\[\n\\begin{align}\n\\mu_{rec} = \\theta_{0,p} + (\\theta_{\\infty,s} - \\theta_{0,p}) \\times (LTP+STP) \\\\\nLTP = 1 - e^{-\\lambda_p \\times time} \\\\\nSTP = \\delta_p \\times (\\frac{time}{\\tau_s} \\times e^{1-\\frac{time}{\\tau_s}})^2 \\\\\n\\theta_{0,p} = \\theta_{\\infty,s} \\times dist_p\n\\end{align}\n\\]"
  },
  {
    "objectID": "92_model_devs.html#parrallel",
    "href": "92_model_devs.html#parrallel",
    "title": "Models devs",
    "section": "Parrallel",
    "text": "Parrallel\ndummy_par.stan"
  },
  {
    "objectID": "93_notes.html#section",
    "href": "93_notes.html#section",
    "title": "Notes",
    "section": "12/02/24",
    "text": "12/02/24\nQuick chat with Camille, list of implementations:\n\ndelta relative to thetaInf\ntau+3 in the model\nexplore new delta boundaries\ncheck the negative value case with new delta expression\nadd random effect with thetaInf_p\ninclude all needed derived parameters (delta_pct, dist_pct, y15)"
  },
  {
    "objectID": "93_notes.html#section-1",
    "href": "93_notes.html#section-1",
    "title": "Notes",
    "section": "31/01/24",
    "text": "31/01/24\n\ndelta upper boundary could be relaxed above 200%\nwe could try using plot level bump timing tau_p\nGeno suggested hiding the points at 20 years for Misiones to see if we have the same issue than in Malinau and then we set a higher minimum bump timing tau min to ca 10 years\nAndes suggested exploring successively the diversity ~ disturbance relationships starting from site, then continent and finally pantropically\nCamille suggested normalizing bump intensity delta with asymptotic value thetaInf\nMarielos suggested to investigate the link between treatments and basal area disturbance index (common with WG2)\nFor the environmental variables, I should add Soil Water Content from ERA5-Land and Dry Season Length from CHIRPS"
  },
  {
    "objectID": "93_notes.html#section-2",
    "href": "93_notes.html#section-2",
    "title": "Notes",
    "section": "29/01/24",
    "text": "29/01/24\nSill to do list:\n\nBefore Thursday:\n\nlog SLA and LA change SLA to LMA\n\nAfter:\n\nthetaInfp\njoint or sequential inference across attributes\nGroup 3 help\nN fixation & dispersal"
  },
  {
    "objectID": "93_notes.html#section-3",
    "href": "93_notes.html#section-3",
    "title": "Notes",
    "section": "24/01/24",
    "text": "24/01/24\nSections are randomly ordered.\n\nData preparation\nSLA and LA should be logged in species functional trait preparation and SLA inverted in LMA. The N fixation and dispersal still needs to be cleaned.\n\n\nModels structure\nWe must use the random effect for control plots by adding thetaInf_p for controls and pre-inventories with only a hyperdistribution on mu_thetaInf and sigma_thetaInf_p (either concatenating or with two likelihoods) and by modifying thetaInfp in the equation (l. 43 & 44 on mu_old and mu_rec).\n\n\nTrajectories\nAdd box plots for prelogging and controls, and plot longer time series from 1 to 60 years with scale transformation for time. The diversity trajectories are not that bad, but may require better data preparation rather than tweaking the model.\n\n\nModel selection\nLOO model selection fails and does not take into account parsimony with the number of parameters. However, the results show that \\(\\lambda\\) is highly correlated between STP and LTP models (e.g. AGB) and the choice may not be necessary or may be made post hoc.\n\n\nDisturbance intensity\n\\(dist_p\\) can represent the intensity of disturbance for attributes where it is well modelled (to be verified with data where possible) to provide information after the HDI on diversity trajectories. Sequential inference problem (uncertainty transmission?) or joint but with influence of diversity trajectory back on \\(dist_p\\). Camille proposes to use a hyperdistribution on \\(dist_p\\), informed with harvested volumes if available.\n\n\nOnline workshop\n3-4 sessions with :\n\nGeneral session on Thursday, a quick introduction to data preparation including environment and species, model development, re-introduction to the model with a quick focus on the constrained disturbance index.\nSubgroup session on Thursday, where subgroups make a first exploration of preliminary parameters for their question of interest with associated covariates.\nGeneral session on Friday where sub-groups present their results.\nOptional subgroup session on Friday if they wish.\n\nWe need to prepare for this:\n\nTrajectory attributes: agb, gini, stem, ba, hill q1 genus index, FDiv, Feve, CWM wd, lma, n, hmax.\nAutomatic rmarkdown pdf report for PIs (no pages yet): agb, gini, stem, ba, hill q1 genus index, FDiv, CWM wd, lma, hmax.\nUpdate Mithila Monday afternoon\nPrepare subgroup data and figures for Wednesday (all parameters with fifth usual quantiles, derived parameter \\(t_{95}\\), associated environmental data with description, maybe some graphs).\n\n\n\nSubgroup 3\nMuch remains to be explored, Sylvain’s offers punctual help on theoretical development in sessions with Géraldine and Camille."
  },
  {
    "objectID": "99_references.html",
    "href": "99_references.html",
    "title": "References",
    "section": "",
    "text": "Marcon, Eric, and Bruno Hérault. 2015.\n“Entropart:\nAnRPackage to Measure and Partition\nDiversity.” Journal of Statistical Software 67 (8). https://doi.org/10.18637/jss.v067.i08.\n\n\nMaurent, Eliott, Bruno Hérault, Camille Piponiot, Géraldine Derroire,\nDiego Delgado, Bryan Finegan, Mélaine Aubry Kientz, Bienvenu H. K.\nAmani, and Marie Ange Ngo Bieng. 2023. “A Common Framework to\nModel Recovery in Disturbed Tropical Forests.” Ecological\nModelling 483 (September): 110418. https://doi.org/10.1016/j.ecolmodel.2023.110418.\n\n\nMouchet, Maud A., Sébastien Villéger, Norman W. H. Mason, and David\nMouillot. 2010. “Functional Diversity Measures: An Overview of\nTheir Redundancy and Their Ability to Discriminate Community Assembly\nRules.” Functional Ecology 24 (4): 867–76. https://doi.org/10.1111/j.1365-2435.2010.01695.x.\n\n\nRéjou-Méchain, Maxime, Ariane Tanguy, Camille Piponiot, Jérôme Chave,\nand Bruno Hérault. 2017. “Biomass: An r Package for Estimating\nAbove-Ground Biomass and Its Uncertainty in Tropical\nForests.” Edited by Sarah Goslee. Methods in Ecology and\nEvolution 8 (9): 1163–67. https://doi.org/10.1111/2041-210x.12753."
  }
]